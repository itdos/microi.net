import{_ as le,u as oe,s as se,r as g,c as ie,o as ne,a as re,n as I,i as de,w as ue,b as v,d as r,e as P,f as ce,v as ge,g as F,h as K,j as N,F as k,k as T,l as V,m as G,p as H,q as ve,t as we,x as pe}from"./index-e3nHg57k.js";import{u as me,g as be}from"./useWidget-R-djxtlI.js";const he={class:"date-range"},fe={__name:"line-widget",props:{widgetObj:{type:Object,required:!0}},setup(h){var C,E,D;const q=oe(),{curWrapper:Q,dark:i}=se(q),e=h,f=g(!1);g([]);const X=async(n,l,u)=>{if(n&&l.optionUrl){f.value=!0;let c={};try{const o=await be(l.optionUrl+n,c);o&&o.length>0&&(e.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[u].options=o),f.value=!1}catch(o){console.error("Error fetching data:",o)}finally{f.value=!1}}},L=g(),A=g(!1),{loadRemoteData:R}=me(e.widgetObj,e.widgetObj.widgetParams[0].typeOptions.dataJson,L,A),S=async()=>{await R(),Y()},y=g(null);let w=null;const Z=ie(()=>{var l;let n=(l=e.widgetObj.widgetParams[1])!=null&&l.value?40:0;return e.widgetObj.widgetOption.height-n+"px"}),a=g({});a.value={title:{show:!0,text:"",subtext:"",textStyle:{color:i.value?"#fff":"#333",fontStyle:"normal",fontWeight:"bolder",fontFamily:"sans-serif",fontSize:18}},tooltip:{trigger:"axis",show:!0,axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{show:!0,type:"scroll",textStyle:{color:i.value?"#999":"#333"},data:[],orient:(C=e.widgetObj.widgetParams[8])==null?void 0:C.value,left:(E=e.widgetObj.widgetParams[9])==null?void 0:E.value},grid:{show:!1,left:"10%",right:"4%",bottom:"30px",containLabel:!1},toolbox:{show:!0,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!0,axisTick:{alignWithLabel:!0},axisLabel:{color:i.value?"#999":"#333"},data:[]},yAxis:{type:"value",splitLine:{show:(D=e.widgetObj.widgetParams[15])==null?void 0:D.value},axisLabel:{formatter:"{value}",color:i.value?"#999":"#333"}},series:[]},ne(()=>{$(),ae()}),re(()=>{te()});const $=async()=>{await R(),U()},U=()=>{I(()=>{w&&w.dispose(),y.value&&(w=de(y.value),Y())})},ee=()=>{w.setOption(a.value)},Y=()=>{var n,l,u,c,o,O,x,j,p,m,b,t;a.value.title.textStyle.color=i.value?"#999":"#333",a.value.legend.textStyle.color=i.value?"#999":"#333",a.value.xAxis.axisLabel.color=i.value?"#999":"#333",a.value.yAxis.axisLabel.color=i.value?"#999":"#333",a.value.legend.orient=(n=e.widgetObj.widgetParams[8])==null?void 0:n.value,a.value.legend.left=(l=e.widgetObj.widgetParams[9])==null?void 0:l.value,a.value.title.text=(u=e.widgetObj.widgetParams[5])==null?void 0:u.value,a.value.title.subtext=(c=e.widgetObj.widgetParams[6])==null?void 0:c.value,a.value.legend.show=(o=e.widgetObj.widgetParams[7])==null?void 0:o.value,a.value.tooltip.show=(O=e.widgetObj.widgetParams[10])==null?void 0:O.value,a.value.tooltip.trigger=(x=e.widgetObj.widgetParams[11])==null?void 0:x.value,a.value.toolbox.show=(j=e.widgetObj.widgetParams[12])==null?void 0:j.value,a.value.xAxis.data=e.widgetObj.widgetParams[0].typeOptions.dataJson.xAxis,a.value.xAxis.boundaryGap=(p=e.widgetObj.widgetParams[2])==null?void 0:p.value,a.value.yAxis.splitLine.show=(m=e.widgetObj.widgetParams[15])==null?void 0:m.value,a.value.series=[],a.value.legend.data=[],(t=(b=e.widgetObj.widgetParams[0].typeOptions.dataJson)==null?void 0:b.series)==null||t.forEach((d,s)=>{var M,B,J,W;const _={type:"line",name:d.name,data:d.data,smooth:(M=e.widgetObj.widgetParams[3])==null?void 0:M.value,label:{show:(B=e.widgetObj.widgetParams[13])==null?void 0:B.value,position:(J=e.widgetObj.widgetParams[14])==null?void 0:J.value}};(W=e.widgetObj.widgetParams[4])!=null&&W.value&&(_.areaStyle={}),a.value.series.push(_),a.value.legend.data.push(d.name)}),ee()},ae=()=>{window.addEventListener("resize",z)},te=()=>{window.removeEventListener("resize",z)},z=()=>{I(()=>{y.value&&w.resize()})};return ue([()=>e.widgetObj,()=>Q.value,()=>i.value],()=>{U(),z()},{deep:!0}),(n,l)=>{var p;const u=v("el-input"),c=v("el-option"),o=v("el-select"),O=v("el-date-picker"),x=v("el-button"),j=v("el-space");return r(),P(k,null,[ce(F("div",he,[K(j,{wrap:""},{default:N(()=>{var m,b;return[(r(!0),P(k,null,T((m=h.widgetObj.widgetParams[0].typeOptions.dataJson)==null?void 0:m.searchData,(t,d)=>(r(),P(k,null,[t.type=="input"?(r(),V(u,{key:d,modelValue:t.value,"onUpdate:modelValue":s=>t.value=s,size:"small",placeholder:"请输入"+t.label,clearable:"",onKeyup:G(S,["enter"])},null,8,["modelValue","onUpdate:modelValue","placeholder"])):t.type=="select"?(r(),V(o,{class:"pagesearch",style:{"min-width":"120px"},key:d+"select",modelValue:t.value,"onUpdate:modelValue":s=>t.value=s,size:"small",placeholder:"请选择"+t.label,clearable:"",filterable:"",remote:"","remote-method":s=>X(s,t,d),loading:f.value,onKeyup:G(S,["enter"])},{default:N(()=>[(r(!0),P(k,null,T(t.options,(s,_)=>(r(),V(c,{value:s.value,label:s.label,key:_+s.value},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","remote-method","loading"])):H("",!0)],64))),256)),(b=h.widgetObj.widgetParams[16])!=null&&b.value?(r(),V(O,{key:0,modelValue:L.value,"onUpdate:modelValue":l[0]||(l[0]=t=>L.value=t),size:"small","unlink-panels":"",type:"monthrange","range-separator":"至","start-placeholder":"起始年月","end-placeholder":"结束年月",format:"YYYY-MM","value-format":"YYYY-MM"},null,8,["modelValue"])):H("",!0),K(x,{icon:ve(we),size:"small",loading:A.value,circle:"",onClick:S},null,8,["icon","loading"])]}),_:1})],512),[[ge,(p=h.widgetObj.widgetParams[1])==null?void 0:p.value]]),F("div",{ref_key:"chartRef",ref:y,style:pe([{width:"100%"},{height:Z.value}])},null,4)],64)}}},xe=le(fe,[["__scopeId","data-v-336e5038"]]);export{xe as default};
