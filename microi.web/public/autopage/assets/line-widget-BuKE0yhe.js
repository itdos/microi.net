import{_ as le,u as oe,s as se,r as i,c as ne,o as re,a as ie,n as F,i as de,w as ue,b as p,d,e as O,f as ce,v as ge,g as K,h as L,j as N,F as j,k as T,l as S,m as G,p as pe,q as ve,t as we,x as me}from"./index-Cdknt3Ns.js";import{u as he,g as be}from"./useWidget-Didqp_4P.js";const fe={class:"date-range"},ye={__name:"line-widget",props:{widgetObj:{type:Object,required:!0}},setup(_){var Y,C,D;const H=oe(),{curWrapper:q,dark:n}=se(H),e=_,Q=i(e.widgetObj.widgetParams[0].typeOptions.dataJson.searchData),h=i(!1);i([]);const X=async(r,o,u)=>{if(r&&o.optionUrl){h.value=!0;let c={};try{const s=await be(o.optionUrl+r,c);s&&s.length>0&&(Q.value[u].options=s),h.value=!1}catch(s){console.error("Error fetching data:",s)}finally{h.value=!1}}},P=i(),z=i(!1),{loadRemoteData:A}=he(e.widgetObj,e.widgetObj.widgetParams[0].typeOptions.dataJson,P,z),k=async()=>{await A(),U()},b=i(null);let v=null;const Z=ne(()=>{var o;let r=(o=e.widgetObj.widgetParams[1])!=null&&o.value?40:0;return e.widgetObj.widgetOption.height-r+"px"}),a=i({});a.value={title:{show:!0,text:"",subtext:"",textStyle:{color:n.value?"#fff":"#333",fontStyle:"normal",fontWeight:"bolder",fontFamily:"sans-serif",fontSize:18}},tooltip:{trigger:"axis",show:!0,axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{show:!0,type:"scroll",textStyle:{color:n.value?"#999":"#333"},data:[],orient:(Y=e.widgetObj.widgetParams[8])==null?void 0:Y.value,left:(C=e.widgetObj.widgetParams[9])==null?void 0:C.value},grid:{show:!1,left:"10%",right:"4%",bottom:"30px",containLabel:!1},toolbox:{show:!0,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!0,axisTick:{alignWithLabel:!0},axisLabel:{color:n.value?"#999":"#333"},data:[]},yAxis:{type:"value",splitLine:{show:(D=e.widgetObj.widgetParams[15])==null?void 0:D.value},axisLabel:{formatter:"{value}",color:n.value?"#999":"#333"}},series:[]},re(()=>{$(),ae()}),ie(()=>{te()});const $=async()=>{await A(),R()},R=()=>{F(()=>{v&&v.dispose(),b.value&&(v=de(b.value),U())})},ee=()=>{v.setOption(a.value)},U=()=>{var r,o,u,c,s,f,y,x,w,m,t,g;a.value.title.textStyle.color=n.value?"#999":"#333",a.value.legend.textStyle.color=n.value?"#999":"#333",a.value.xAxis.axisLabel.color=n.value?"#999":"#333",a.value.yAxis.axisLabel.color=n.value?"#999":"#333",a.value.legend.orient=(r=e.widgetObj.widgetParams[8])==null?void 0:r.value,a.value.legend.left=(o=e.widgetObj.widgetParams[9])==null?void 0:o.value,a.value.title.text=(u=e.widgetObj.widgetParams[5])==null?void 0:u.value,a.value.title.subtext=(c=e.widgetObj.widgetParams[6])==null?void 0:c.value,a.value.legend.show=(s=e.widgetObj.widgetParams[7])==null?void 0:s.value,a.value.tooltip.show=(f=e.widgetObj.widgetParams[10])==null?void 0:f.value,a.value.tooltip.trigger=(y=e.widgetObj.widgetParams[11])==null?void 0:y.value,a.value.toolbox.show=(x=e.widgetObj.widgetParams[12])==null?void 0:x.value,a.value.xAxis.data=e.widgetObj.widgetParams[0].typeOptions.dataJson.xAxis,a.value.xAxis.boundaryGap=(w=e.widgetObj.widgetParams[2])==null?void 0:w.value,a.value.yAxis.splitLine.show=(m=e.widgetObj.widgetParams[15])==null?void 0:m.value,a.value.series=[],a.value.legend.data=[],(g=(t=e.widgetObj.widgetParams[0].typeOptions.dataJson)==null?void 0:t.series)==null||g.forEach((l,E)=>{var B,J,W,I;const M={type:"line",name:l.name,data:l.data,smooth:(B=e.widgetObj.widgetParams[3])==null?void 0:B.value,label:{show:(J=e.widgetObj.widgetParams[13])==null?void 0:J.value,position:(W=e.widgetObj.widgetParams[14])==null?void 0:W.value}};(I=e.widgetObj.widgetParams[4])!=null&&I.value&&(M.areaStyle={}),a.value.series.push(M),a.value.legend.data.push(l.name)}),ee()},ae=()=>{window.addEventListener("resize",V)},te=()=>{window.removeEventListener("resize",V)},V=()=>{F(()=>{b.value&&v.resize()})};return ue([()=>e.widgetObj,()=>q.value,()=>n.value],()=>{R(),V()},{deep:!0}),(r,o)=>{var w;const u=p("el-input"),c=p("el-option"),s=p("el-select"),f=p("el-date-picker"),y=p("el-button"),x=p("el-space");return d(),O(j,null,[ce(K("div",fe,[L(x,{wrap:""},{default:N(()=>{var m;return[(d(!0),O(j,null,T((m=_.widgetObj.widgetParams[0].typeOptions.dataJson)==null?void 0:m.searchData,(t,g)=>(d(),O(j,null,[t.type=="input"?(d(),S(u,{key:g,modelValue:t.value,"onUpdate:modelValue":l=>t.value=l,size:"small",placeholder:"请输入"+t.label,clearable:"",onKeyup:G(k,["enter"])},null,8,["modelValue","onUpdate:modelValue","placeholder"])):t.type=="select"?(d(),S(s,{class:"pagesearch",style:{"min-width":"120px"},key:g+"select",modelValue:t.value,"onUpdate:modelValue":l=>t.value=l,size:"small",placeholder:"请选择"+t.label,clearable:"",filterable:"",remote:"","remote-method":l=>X(l,t,g),loading:h.value,onKeyup:G(k,["enter"])},{default:N(()=>[(d(!0),O(j,null,T(t.options,(l,E)=>(d(),S(c,{value:l.value,label:l.label,key:E+l.value},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","remote-method","loading"])):pe("",!0)],64))),256)),L(f,{size:"small",modelValue:P.value,"onUpdate:modelValue":o[0]||(o[0]=t=>P.value=t),"unlink-panels":"",type:"monthrange","range-separator":"至","start-placeholder":"起始年月","end-placeholder":"结束年月",format:"YYYY-MM","value-format":"YYYY-MM"},null,8,["modelValue"]),L(y,{size:"small",icon:ve(we),loading:z.value,circle:"",onClick:k},null,8,["icon","loading"])]}),_:1})],512),[[ge,(w=_.widgetObj.widgetParams[1])==null?void 0:w.value]]),K("div",{ref_key:"chartRef",ref:b,style:me([{width:"100%"},{height:Z.value}])},null,4)],64)}}},je=le(ye,[["__scopeId","data-v-4996a137"]]);export{je as default};
