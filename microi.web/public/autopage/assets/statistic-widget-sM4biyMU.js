import{_ as $,r as b,o as ee,y as ae,c as y,b as i,d as n,e as f,f as te,v as le,g as V,h as v,j as c,F as O,k as S,l as p,m as x,p as E,q as oe,t as se,x as _,N as ne,A as re,M as K}from"./index-CXgNbF0w.js";import{u as de,g as ie}from"./useWidget-mapG2dm_.js";const ue={class:"date-range"},ce={__name:"statistic-widget",props:{widgetObj:{type:Object,required:!0}},async setup(u){let C,D;const e=u,h=b(!1);b([]);const R=async(a,t,l)=>{if(a&&t.optionUrl){h.value=!0;let g={};try{const m=await ie(t.optionUrl+a,g);m&&m.length>0&&(e.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[l].options=m),h.value=!1}catch(m){console.error("Error fetching data:",m)}finally{h.value=!1}}},w=b({});ee(()=>{e.widgetObj.widgetParams[0].typeOptions.dataJson.searchData.forEach((a,t)=>{w.value[t]=a.value})});const j=async a=>{const t={...w.value};for(const[l,g]of Object.entries(t))e.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[l]&&(e.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[l].value=g);await z()},k=b(),J=b(!1),{loadRemoteData:z}=de(e.widgetObj,e.widgetObj.widgetParams[0].typeOptions.dataJson,k,J);[C,D]=ae(()=>z()),await C,D();const A=y(()=>{var a,t;return{backgroundColor:(a=e.widgetObj.widgetParams[2])==null?void 0:a.value,padding:(t=e.widgetObj.widgetParams[3])==null?void 0:t.value}}),F=y(()=>{var a,t,l,g;return{fontSize:(a=e.widgetObj.widgetParams[7])==null?void 0:a.value,fontWeight:(t=e.widgetObj.widgetParams[8])==null?void 0:t.value,color:(l=e.widgetObj.widgetParams[9])==null?void 0:l.value,margin:(g=e.widgetObj.widgetParams[10])==null?void 0:g.value}}),L=y(()=>{var a,t,l;return{fontSize:(a=e.widgetObj.widgetParams[11])==null?void 0:a.value,fontWeight:(t=e.widgetObj.widgetParams[12])==null?void 0:t.value,color:(l=e.widgetObj.widgetParams[13])==null?void 0:l.value}}),Y=y(()=>{var a,t;return{color:(a=e.widgetObj.widgetParams[15])==null?void 0:a.value,fontSize:(t=e.widgetObj.widgetParams[16])==null?void 0:t.value}}),q=y(()=>{var a;return(a=e.widgetObj.widgetParams[0].typeOptions.dataJson)!=null&&a.data?e.widgetObj.widgetParams[0].typeOptions.dataJson.data:e.widgetObj.widgetParams[0].typeOptions.dataJson});return(a,t)=>{var U;const l=i("el-input"),g=i("el-option"),m=i("el-select"),G=i("el-date-picker"),H=i("el-button"),Q=i("el-space"),M=i("el-icon"),T=i("el-statistic"),X=i("el-col"),Z=i("el-row");return n(),f(O,null,[te(V("div",ue,[v(Q,{wrap:""},{default:c(()=>{var r;return[(n(!0),f(O,null,S(e.widgetObj.widgetParams[0].typeOptions.dataJson.searchData,(o,d)=>(n(),f(O,null,[o.type=="input"?(n(),p(l,{key:d,modelValue:w.value[d],"onUpdate:modelValue":s=>w.value[d]=s,size:"small",placeholder:"请输入"+o.label,clearable:"",onKeyup:x(j,["enter"])},null,8,["modelValue","onUpdate:modelValue","placeholder"])):o.type=="select"?(n(),p(m,{class:"pagesearch",style:{"min-width":"120px"},key:d+"select",modelValue:w.value[d],"onUpdate:modelValue":s=>w.value[d]=s,onChange:j,size:"small",placeholder:"请选择"+o.label,clearable:"",filterable:"",remote:"","remote-method":s=>R(s,o,d),loading:h.value,onKeyup:x(j,["enter"])},{default:c(()=>[(n(!0),f(O,null,S(o.options,(s,P)=>(n(),p(g,{value:s.value,label:s.label,key:P+s.value},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","remote-method","loading"])):E("",!0)],64))),256)),(r=u.widgetObj.widgetParams[19])!=null&&r.value?(n(),p(G,{key:0,modelValue:k.value,"onUpdate:modelValue":t[0]||(t[0]=o=>k.value=o),size:"small","unlink-panels":"",type:"monthrange","range-separator":"至","start-placeholder":"起始年月","end-placeholder":"结束年月",format:"YYYY-MM","value-format":"YYYY-MM"},null,8,["modelValue"])):E("",!0),v(H,{icon:oe(se),size:"small",loading:J.value,circle:"",onClick:j},null,8,["icon","loading"])]}),_:1})],512),[[le,(U=u.widgetObj.widgetParams[18])==null?void 0:U.value]]),v(Z,{style:{width:"100%"}},{default:c(()=>[(n(!0),f(O,null,S(q.value,(r,o)=>{var d;return n(),p(X,{key:o,class:"el-col",span:(d=u.widgetObj.widgetParams[1])==null?void 0:d.value,style:_(A.value)},{default:c(()=>{var s,P,B,I,N,W;return[v(T,{style:_([{backgroundColor:r.bgColor?r.bgColor:(P=(s=u.widgetObj.widgetParams[4])==null?void 0:s.value)==null?void 0:P.split(",")[o>7?0:o]},{padding:(B=u.widgetObj.widgetParams[5])==null?void 0:B.value},{borderRadius:(I=u.widgetObj.widgetParams[6])==null?void 0:I.value},{backgroundImage:r.bgImage?r.bgImage:"url("+((N=u.widgetObj.widgetParams[17])==null?void 0:N.value)+")"}]),"value-style":L.value,value:r.value},ne({title:c(()=>[V("div",{style:_(F.value)},[V("span",null,re(r.name),1)],4)]),_:2},[((W=u.widgetObj.widgetParams[14])==null?void 0:W.value)=="prefix"?{name:"prefix",fn:c(()=>[v(M,{style:_(Y.value)},{default:c(()=>[(n(),p(K(r.icon)))]),_:2},1032,["style"])]),key:"0"}:{name:"suffix",fn:c(()=>[v(M,{style:_(Y.value)},{default:c(()=>[(n(),p(K(r.icon)))]),_:2},1032,["style"])]),key:"1"}]),1032,["style","value-style","value"])]}),_:2},1032,["span","style"])}),128))]),_:1})],64)}}},pe=$(ce,[["__scopeId","data-v-024f1550"]]);export{pe as default};
