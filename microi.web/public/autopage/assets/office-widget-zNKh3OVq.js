const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-BRgSGfeO.js","./index-BE8h2APJ.js","./index-92pQ9dre.css","./vue.runtime.esm-bundler-CwkYUWoJ.js","./index-BtB_Hoyp.js","./index-Bhuf2EHv.js"])))=>i.map(i=>d[i]);
import{u as O,s as v,M as C,j as u,r,w as E,d as m,e as j,l as b,m as D,N as I,z as i,A as s}from"./index-BE8h2APJ.js";import{u as L}from"./useWidget-zACt1HtQ.js";import"./axiosInstance-Czgay9gA.js";const S={__name:"office-widget",props:{widgetObj:{type:Object,required:!0}},async setup(l){let c,d;const p=O(),{formData:a,curWidget:U,components:A}=v(p),o=l,n=C(),g=u(()=>{var f;const t=new URLSearchParams(window.parent.location.hash).get("filePath");return console.log("iframePath",t),t?decodeURIComponent(t):a.value.filePath?(console.log("formData.value.filePath",a.value.filePath),decodeURIComponent(a.value.filePath)):n.query.filePath?decodeURIComponent(n.query.filePath):decodeURIComponent((f=o.widgetObj.widgetParams[0].typeOptions.dataJson)==null?void 0:f.filePath)}),h=r(),_=u(()=>{let e=n.query.filePath;return e||(e=o.widgetObj.widgetParams[0].typeOptions.dataJson.filePath),e&&e.toLowerCase().includes("doc")?i(()=>s(()=>import("./index-BRgSGfeO.js").then(t=>t.i),__vite__mapDeps([0,1,2,3]),import.meta.url)):e&&e.toLowerCase().includes("xls")?i(()=>s(()=>import("./index-BtB_Hoyp.js").then(t=>t.i),__vite__mapDeps([4,1,2,3]),import.meta.url)):e&&e.toLowerCase().includes("pdf")?i(()=>s(()=>import("./index-Bhuf2EHv.js").then(t=>t.i),__vite__mapDeps([5,1,2,3]),import.meta.url)):null}),P=r(),w=r(!1),{loadRemoteData:R}=L(o.widgetObj,o.widgetObj.widgetParams[0].typeOptions.dataJson,P,w);[c,d]=E(()=>R()),await c,d();const y=()=>{console.log("office-widget 已加载完成")};return(e,t)=>(m(),j("div",{class:"office-widget",ref_key:"officeWidgetRef",ref:h},[(m(),b(I(_.value),{class:"office-component",src:g.value,onRendered:y,style:D({height:l.widgetObj.widgetOption.height+"px"})},null,40,["src","style"]))],512))}};export{S as default};
