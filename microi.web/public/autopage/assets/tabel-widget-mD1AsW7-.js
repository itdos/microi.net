import{_ as ee,b as s,d as t,l as d,N as ne,j as b,g as S,M as oe,z as X,A as B,e as w,F as j,k as D,p as x,r as f,c as re,y as se,f as de,v as ue,h as K,m as Z,q as ie,t as ce,x as me}from"./index-CfICaLg9.js";import{u as ge,g as we}from"./useWidget-zuxP2hw3.js";const be={key:3,style:{"margin-left":"5px"}},pe={__name:"RecursiveTableColumn",props:{column:{type:Object,required:!0},widgetObj:{type:Object,required:!0}},setup(e){return(U,_)=>{const u=s("el-tag"),P=s("el-progress"),p=s("el-rate"),Y=s("recursive-table-column",!0),V=s("el-table-column");return t(),d(V,{prop:e.column.prop,label:e.column.label,width:e.column.width,align:e.column.align},ne({default:b(()=>[e.column.children?(t(!0),w(j,{key:0},D(e.column.children,(a,c)=>(t(),d(Y,{key:c,column:a,"widget-obj":e.widgetObj},null,8,["column","widget-obj"]))),128)):x("",!0)]),_:2},[e.column.children?void 0:{name:"header",fn:b(a=>[S("div",null,[(t(),d(oe(e.column.icon),{class:"icons"})),X(" "+B(a.column.label),1)])]),key:"0"},e.column.children?void 0:{name:"default",fn:b(a=>{var c;return[S("div",null,[e.column.status_ui&&a.row.status_ui?(t(),d(u,{key:0,type:a.row.status_ui},{default:b(()=>[X(B(a.row[e.column.prop]),1)]),_:2},1032,["type"])):e.column.progress_ui&&a.row.progress_ui?(t(),d(P,{key:1,"text-inside":!0,"stroke-width":(c=e.widgetObj.widgetParams[5])==null?void 0:c.value,status:a.row.progress_ui,percentage:a.row[e.column.prop]},null,8,["stroke-width","status","percentage"])):e.column.rate_ui?(t(),d(p,{key:2,"allow-half":"",disabled:"","show-score":"",modelValue:a.row[e.column.prop],"onUpdate:modelValue":J=>a.row[e.column.prop]=J},null,8,["modelValue","onUpdate:modelValue"])):(t(),w("span",be,B(a.row[e.column.prop]),1))])]}),key:"1"}]),1032,["prop","label","width","align"])}}},ye=ee(pe,[["__scopeId","data-v-ea4e1344"]]),ve={class:"date-range"},he={style:{"margin-top":"12px",display:"flex","justify-content":"flex-end"}},fe={__name:"tabel-widget",props:{widgetObj:{type:Object,required:!0}},async setup(e){let U,_;const u=e,P=f(u.widgetObj.widgetParams[0].typeOptions.dataJson.searchData),p=f(!1);f([]);const Y=async(n,l,g)=>{if(n&&l.optionUrl){p.value=!0;let O={};try{const o=await we(l.optionUrl+n,O);o&&o.length>0&&(P.value[g].options=o),p.value=!1}catch(o){console.error("Error fetching data:",o)}finally{p.value=!1}}},V=re(()=>{var l;let n=10;return u.widgetObj.widgetParams[7]&&(n=(l=u.widgetObj.widgetParams[7])==null?void 0:l.value),n}),a=f(1),c=async n=>{a.value=1,await z()},J=async n=>{a.value=1,await z()},ae=async n=>{await z()},q=[];q.value=u.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData;const M=f(),T=f(!1),{loadRemoteData:z}=ge(u.widgetObj,q.value,M,T,a);[U,_]=se(()=>z()),await U,_();const A=n=>n.map(l=>l.children?{...l,children:A(l.children)}:l),te=({row:n,column:l,rowIndex:g,columnIndex:O})=>{var C;let o=(C=u.widgetObj.widgetParams[6])==null?void 0:C.value;if(!o)return{rowspan:1,colspan:1};let y=u.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData,N=u.widgetObj.widgetParams[0].typeOptions.dataJson.headerData.findIndex(v=>v.prop==o);if(O===N){const v=y[g-1];if(y[g+1],v&&v[o]===n[o])return{rowspan:0,colspan:0};let k=1;for(let h=g+1;h<y.length&&y[h][o]===n[o];h++)k++;return{rowspan:k,colspan:1}}};return(n,l)=>{var k,h,F,I,L,W,$,G,H,Q;const g=s("el-input"),O=s("el-option"),o=s("el-select"),y=s("el-date-picker"),E=s("el-button"),N=s("el-space"),C=s("el-table"),v=s("el-pagination");return t(),w(j,null,[de(S("div",ve,[K(N,{wrap:""},{default:b(()=>{var m;return[(t(!0),w(j,null,D(P.value,(r,R)=>(t(),w(j,null,[r.type=="input"?(t(),d(g,{key:R,modelValue:r.value,"onUpdate:modelValue":i=>r.value=i,size:"small",placeholder:"请输入"+r.label,clearable:"",onKeyup:Z(c,["enter"])},null,8,["modelValue","onUpdate:modelValue","placeholder"])):r.type=="select"?(t(),d(o,{class:"pagesearch",style:{"min-width":"120px"},key:R+"select",modelValue:r.value,"onUpdate:modelValue":i=>r.value=i,size:"small",placeholder:"请选择"+r.label,clearable:"",filterable:"",remote:"","remote-method":i=>Y(i,r,R),loading:p.value,onKeyup:Z(c,["enter"])},{default:b(()=>[(t(!0),w(j,null,D(r.options,(i,le)=>(t(),d(O,{value:i.value,label:i.label,key:le+i.value},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","remote-method","loading"])):x("",!0)],64))),256)),(m=e.widgetObj.widgetParams[13])!=null&&m.value?(t(),d(y,{key:0,modelValue:M.value,"onUpdate:modelValue":l[0]||(l[0]=r=>M.value=r),size:"small","unlink-panels":"",type:"monthrange","range-separator":"至","start-placeholder":"起始年月","end-placeholder":"结束年月",format:"YYYY-MM","value-format":"YYYY-MM"},null,8,["modelValue"])):x("",!0),K(E,{icon:ie(ce),size:"small",loading:T.value,circle:"",onClick:c},null,8,["icon","loading"])]}),_:1})],512),[[ue,(k=e.widgetObj.widgetParams[1])==null?void 0:k.value]]),K(C,{data:e.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData,stripe:(h=e.widgetObj.widgetParams[2])==null?void 0:h.value,border:(F=e.widgetObj.widgetParams[3])==null?void 0:F.value,size:(I=e.widgetObj.widgetParams[4])==null?void 0:I.value,"span-method":te,"show-summary":(L=e.widgetObj.widgetParams[8])==null?void 0:L.value,style:me({"--el-table-border-color":(W=e.widgetObj.widgetParams[9])==null?void 0:W.value}),"header-cell-style":{background:($=e.widgetObj.widgetParams[10])==null?void 0:$.value,color:(G=e.widgetObj.widgetParams[11])==null?void 0:G.value},"cell-style":{color:(H=e.widgetObj.widgetParams[12])==null?void 0:H.value}},{default:b(()=>[(t(!0),w(j,null,D(A(e.widgetObj.widgetParams[0].typeOptions.dataJson.headerData),(m,r)=>(t(),d(ye,{key:r,column:m,"widget-obj":e.widgetObj},null,8,["column","widget-obj"]))),128))]),_:1},8,["data","stripe","border","size","show-summary","style","header-cell-style","cell-style"]),S("div",he,[e.widgetObj.widgetParams[7]&&((Q=e.widgetObj.widgetParams[7])==null?void 0:Q.value)!=-1?(t(),d(v,{key:0,layout:"prev, pager, next",background:"",size:"small","hide-on-single-page":!1,total:e.widgetObj.widgetParams[0].typeOptions.dataJson.total,"current-page":a.value,"onUpdate:currentPage":l[1]||(l[1]=m=>a.value=m),"page-size":V.value,"onUpdate:pageSize":l[2]||(l[2]=m=>V.value=m),onSizeChange:J,onCurrentChange:ae},null,8,["total","current-page","page-size"])):x("",!0)])],64)}}},ke=ee(fe,[["__scopeId","data-v-089f85d1"]]);export{ke as default};
