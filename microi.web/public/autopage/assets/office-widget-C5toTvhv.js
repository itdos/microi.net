const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-CdUFgUhB.js","./index-VdJnV-Xx.js","./index-BmKzHBDp.css","./vue.runtime.esm-bundler-ByOg9omu.js","./index-UhWHvrf1.js","./index-BQBhPnIU.js"])))=>i.map(i=>d[i]);
import{u as O,s as v,N as C,l as u,r,w as E,d as m,e as b,p as j,q as D,O as I,B as i,C as s}from"./index-VdJnV-Xx.js";import{u as L}from"./useWidget-MIMwv8H2.js";import"./axiosInstance-jW9wSf4p.js";const B={__name:"office-widget",props:{widgetObj:{type:Object,required:!0}},async setup(l){let c,d;const p=O(),{formData:a,curWidget:U,components:q}=v(p),o=l,n=C(),g=u(()=>{var f;const t=new URLSearchParams(window.parent.location.hash).get("filePath");return console.log("iframePath",t),t?decodeURIComponent(t):a.value.filePath?(console.log("formData.value.filePath",a.value.filePath),decodeURIComponent(a.value.filePath)):n.query.filePath?decodeURIComponent(n.query.filePath):decodeURIComponent((f=o.widgetObj.widgetParams[0].typeOptions.dataJson)==null?void 0:f.filePath)}),h=r(),_=u(()=>{let e=n.query.filePath;return e||(e=o.widgetObj.widgetParams[0].typeOptions.dataJson.filePath),e&&e.toLowerCase().includes("doc")?i(()=>s(()=>import("./index-CdUFgUhB.js").then(t=>t.i),__vite__mapDeps([0,1,2,3]),import.meta.url)):e&&e.toLowerCase().includes("xls")?i(()=>s(()=>import("./index-UhWHvrf1.js").then(t=>t.i),__vite__mapDeps([4,1,2,3]),import.meta.url)):e&&e.toLowerCase().includes("pdf")?i(()=>s(()=>import("./index-BQBhPnIU.js").then(t=>t.i),__vite__mapDeps([5,1,2,3]),import.meta.url)):null}),P=r(),w=r(!1),{loadRemoteData:R}=L(o.widgetObj,o.widgetObj.widgetParams[0].typeOptions.dataJson,P,w);[c,d]=E(()=>R()),await c,d();const y=()=>{console.log("office-widget 已加载完成")};return(e,t)=>(m(),b("div",{class:"office-widget",ref_key:"officeWidgetRef",ref:h},[(m(),j(I(_.value),{class:"office-component",src:g.value,onRendered:y,style:D({height:l.widgetObj.widgetOption.height+"px"})},null,40,["src","style"]))],512))}};export{B as default};
