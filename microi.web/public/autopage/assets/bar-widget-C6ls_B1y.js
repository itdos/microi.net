import{_ as T,u as q,s as G,r as z,l as H,a as J,m as V,n as E,b as M,d as I,e as N,p as U,f as K,q as Q,F as X,k as Y}from"./index-Cd0LJEJn.js";import{C as Z}from"./CommonSearch-CKeA7ir0.js";import"./useWidget-gUdKlkzY.js";const $={__name:"bar-widget",props:{widgetObj:{type:Object,required:!0}},setup(r){var w,v,c,b,m;const B=q(),{curWrapper:R,dark:a}=G(B),e=r,o=z(null);let l=null;const C=H(()=>{var i;let s=(i=e.widgetObj.widgetParams[1])!=null&&i.value?40:0;return e.widgetObj.widgetOption.height-s+"px"}),t=z({});t.value={title:{show:!0,text:"",subtext:"",textStyle:{color:a.value?"#999":"#333",fontStyle:"normal",fontWeight:"bolder",fontFamily:"sans-serif",fontSize:18}},tooltip:{trigger:"axis",show:!0,axisPointer:{type:(w=e.widgetObj.widgetParams[3])==null?void 0:w.value,label:{backgroundColor:"#6a7985"}}},legend:{show:!0,type:"scroll",textStyle:{color:a.value?"#999":"#333"},data:[],orient:(v=e.widgetObj.widgetParams[8])==null?void 0:v.value,left:(c=e.widgetObj.widgetParams[9])==null?void 0:c.value},grid:{show:!1,left:"10%",right:"4%",bottom:"30px",containLabel:!1},toolbox:{show:!0,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!0,axisTick:{alignWithLabel:!0},axisLabel:{color:a.value?"#999":"#333"},data:[]},yAxis:{type:"value",splitLine:{show:(b=e.widgetObj.widgetParams[15])==null?void 0:b.value},axisLabel:{formatter:"{value} "+((m=e.widgetObj.widgetParams[4])==null?void 0:m.value),color:a.value?"#999":"#333"}},series:[]},J(()=>{window.addEventListener("resize",d)}),V(()=>{window.removeEventListener("resize",d)});const n=()=>{console.log("重置数据"),E(()=>{l&&l.dispose(),o.value&&(l=Y(o.value),g())})},D=()=>{l.setOption(t.value)},g=()=>{var s,i,p,x,O,h,f,j,y,P,S,k;t.value.title.textStyle.color=a.value?"#999":"#333",t.value.legend.textStyle.color=a.value?"#999":"#333",t.value.xAxis.axisLabel.color=a.value?"#999":"#333",t.value.yAxis.axisLabel.color=a.value?"#999":"#333",t.value.tooltip.axisPointer.type=(s=e.widgetObj.widgetParams[3])==null?void 0:s.value,t.value.legend.orient=(i=e.widgetObj.widgetParams[8])==null?void 0:i.value,t.value.legend.left=(p=e.widgetObj.widgetParams[9])==null?void 0:p.value,t.value.title.text=(x=e.widgetObj.widgetParams[5])==null?void 0:x.value,t.value.title.subtext=(O=e.widgetObj.widgetParams[6])==null?void 0:O.value,t.value.legend.show=(h=e.widgetObj.widgetParams[7])==null?void 0:h.value,t.value.tooltip.show=(f=e.widgetObj.widgetParams[10])==null?void 0:f.value,t.value.tooltip.trigger=(j=e.widgetObj.widgetParams[11])==null?void 0:j.value,t.value.toolbox.show=(y=e.widgetObj.widgetParams[12])==null?void 0:y.value,t.value.xAxis.data=e.widgetObj.widgetParams[0].typeOptions.dataJson.xAxis,t.value.xAxis.boundaryGap=(P=e.widgetObj.widgetParams[2])==null?void 0:P.value,t.value.yAxis.splitLine.show=(S=e.widgetObj.widgetParams[15])==null?void 0:S.value,t.value.series=[],t.value.legend.data=[],(k=e.widgetObj.widgetParams[0].typeOptions.dataJson.series)==null||k.forEach((u,ee)=>{var L,A;const F={type:"bar",name:u.name,data:u.data,tooltip:{valueFormatter:function(W){var _;return W+" "+((_=e.widgetObj.widgetParams[4])==null?void 0:_.value)}},label:{show:(L=e.widgetObj.widgetParams[13])==null?void 0:L.value,position:(A=e.widgetObj.widgetParams[14])==null?void 0:A.value}};t.value.series.push(F),t.value.legend.data.push(u.name)}),D()},d=()=>{E(()=>{o.value&&l.resize()})};return M([()=>e.widgetObj,()=>R.value,()=>a.value],()=>{n(),d()},{deep:!0}),(s,i)=>(I(),N(X,null,[(I(),U(Z,{widgetObj:r.widgetObj,searchIndex:1,pickerIndex:16,key:r.widgetObj.widgetOption.number,onSetData:g,onResetData:n},null,8,["widgetObj"])),K("div",{ref_key:"chartRef",ref:o,style:Q([{width:"100%"},{height:C.value}])},null,4)],64))}},le=T($,[["__scopeId","data-v-1d1d2282"]]);export{le as default};
