import{_ as ae,b as r,d as a,l as d,N as ne,j as b,g as U,M as oe,z as Z,A as K,e as w,F as O,k as x,p as S,r as P,c as re,y as se,f as de,v as ue,h as q,m as ee,q as ie,t as ce,x as me}from"./index-e3nHg57k.js";import{u as ge,g as we}from"./useWidget-R-djxtlI.js";const be={key:3,style:{"margin-left":"5px"}},pe={__name:"RecursiveTableColumn",props:{column:{type:Object,required:!0},widgetObj:{type:Object,required:!0}},setup(e){return(J,Y)=>{const u=r("el-tag"),p=r("el-progress"),_=r("el-rate"),V=r("recursive-table-column",!0),m=r("el-table-column");return a(),d(m,{prop:e.column.prop,label:e.column.label,width:e.column.width,align:e.column.align},ne({default:b(()=>[e.column.children?(a(!0),w(O,{key:0},x(e.column.children,(l,y)=>(a(),d(V,{key:y,column:l,"widget-obj":e.widgetObj},null,8,["column","widget-obj"]))),128)):S("",!0)]),_:2},[e.column.children?void 0:{name:"header",fn:b(l=>[U("div",null,[(a(),d(oe(e.column.icon),{class:"icons"})),Z(" "+K(l.column.label),1)])]),key:"0"},e.column.children?void 0:{name:"default",fn:b(l=>{var y;return[U("div",null,[e.column.status_ui&&l.row.status_ui?(a(),d(u,{key:0,type:l.row.status_ui},{default:b(()=>[Z(K(l.row[e.column.prop]),1)]),_:2},1032,["type"])):e.column.progress_ui&&l.row.progress_ui?(a(),d(p,{key:1,"text-inside":!0,"stroke-width":(y=e.widgetObj.widgetParams[5])==null?void 0:y.value,status:l.row.progress_ui,percentage:l.row[e.column.prop]},null,8,["stroke-width","status","percentage"])):e.column.rate_ui?(a(),d(_,{key:2,"allow-half":"",disabled:"","show-score":"",modelValue:l.row[e.column.prop],"onUpdate:modelValue":M=>l.row[e.column.prop]=M},null,8,["modelValue","onUpdate:modelValue"])):(a(),w("span",be,K(l.row[e.column.prop]),1))])]}),key:"1"}]),1032,["prop","label","width","align"])}}},ye=ae(pe,[["__scopeId","data-v-ea4e1344"]]),ve={class:"date-range"},he={style:{"margin-top":"12px",display:"flex","justify-content":"flex-end"}},fe={__name:"tabel-widget",props:{widgetObj:{type:Object,required:!0}},async setup(e){let J,Y;const u=e,p=P(!1);P([]);const _=async(n,t,g)=>{if(n&&t.optionUrl){p.value=!0;let j={};try{const o=await we(t.optionUrl+n,j);o&&o.length>0&&(u.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[g].options=o),p.value=!1}catch(o){console.error("Error fetching data:",o)}finally{p.value=!1}}},V=re(()=>{var t;let n=10;return u.widgetObj.widgetParams[7]&&(n=(t=u.widgetObj.widgetParams[7])==null?void 0:t.value),n}),m=P(1),l=async n=>{m.value=1,await z()},y=async n=>{m.value=1,await z()},M=async n=>{await z()},T=[];T.value=u.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData;const N=P(),A=P(!1),{loadRemoteData:z}=ge(u.widgetObj,T.value,N,A,m);[J,Y]=se(()=>z()),await J,Y();const E=n=>n.map(t=>t.children?{...t,children:E(t.children)}:t),te=({row:n,column:t,rowIndex:g,columnIndex:j})=>{var C;let o=(C=u.widgetObj.widgetParams[6])==null?void 0:C.value;if(!o)return{rowspan:1,colspan:1};let v=u.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData,R=u.widgetObj.widgetParams[0].typeOptions.dataJson.headerData.findIndex(h=>h.prop==o);if(j===R){const h=v[g-1];if(v[g+1],h&&h[o]===n[o])return{rowspan:0,colspan:0};let k=1;for(let f=g+1;f<v.length&&v[f][o]===n[o];f++)k++;return{rowspan:k,colspan:1}}};return(n,t)=>{var k,f,I,L,W,$,G,H,Q,X;const g=r("el-input"),j=r("el-option"),o=r("el-select"),v=r("el-date-picker"),F=r("el-button"),R=r("el-space"),C=r("el-table"),h=r("el-pagination");return a(),w(O,null,[de(U("div",ve,[q(R,{wrap:""},{default:b(()=>{var c,D;return[(a(!0),w(O,null,x((c=e.widgetObj.widgetParams[0].typeOptions.dataJson)==null?void 0:c.searchData,(s,B)=>(a(),w(O,null,[s.type=="input"?(a(),d(g,{key:B,modelValue:s.value,"onUpdate:modelValue":i=>s.value=i,size:"small",placeholder:"请输入"+s.label,clearable:"",onKeyup:ee(l,["enter"])},null,8,["modelValue","onUpdate:modelValue","placeholder"])):s.type=="select"?(a(),d(o,{class:"pagesearch",style:{"min-width":"120px"},key:B+"select",modelValue:s.value,"onUpdate:modelValue":i=>s.value=i,size:"small",placeholder:"请选择"+s.label,clearable:"",filterable:"",remote:"","remote-method":i=>_(i,s,B),loading:p.value,onKeyup:ee(l,["enter"])},{default:b(()=>[(a(!0),w(O,null,x(s.options,(i,le)=>(a(),d(j,{value:i.value,label:i.label,key:le+i.value},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","remote-method","loading"])):S("",!0)],64))),256)),(D=e.widgetObj.widgetParams[13])!=null&&D.value?(a(),d(v,{key:0,modelValue:N.value,"onUpdate:modelValue":t[0]||(t[0]=s=>N.value=s),size:"small","unlink-panels":"",type:"monthrange","range-separator":"至","start-placeholder":"起始年月","end-placeholder":"结束年月",format:"YYYY-MM","value-format":"YYYY-MM"},null,8,["modelValue"])):S("",!0),q(F,{icon:ie(ce),size:"small",loading:A.value,circle:"",onClick:l},null,8,["icon","loading"])]}),_:1})],512),[[ue,(k=e.widgetObj.widgetParams[1])==null?void 0:k.value]]),q(C,{data:e.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData,stripe:(f=e.widgetObj.widgetParams[2])==null?void 0:f.value,border:(I=e.widgetObj.widgetParams[3])==null?void 0:I.value,size:(L=e.widgetObj.widgetParams[4])==null?void 0:L.value,"span-method":te,"show-summary":(W=e.widgetObj.widgetParams[8])==null?void 0:W.value,style:me({"--el-table-border-color":($=e.widgetObj.widgetParams[9])==null?void 0:$.value}),"header-cell-style":{background:(G=e.widgetObj.widgetParams[10])==null?void 0:G.value,color:(H=e.widgetObj.widgetParams[11])==null?void 0:H.value},"cell-style":{color:(Q=e.widgetObj.widgetParams[12])==null?void 0:Q.value}},{default:b(()=>[(a(!0),w(O,null,x(E(e.widgetObj.widgetParams[0].typeOptions.dataJson.headerData),(c,D)=>(a(),d(ye,{key:D,column:c,"widget-obj":e.widgetObj},null,8,["column","widget-obj"]))),128))]),_:1},8,["data","stripe","border","size","show-summary","style","header-cell-style","cell-style"]),U("div",he,[e.widgetObj.widgetParams[7]&&((X=e.widgetObj.widgetParams[7])==null?void 0:X.value)!=-1?(a(),d(h,{key:0,layout:"prev, pager, next",background:"",size:"small","hide-on-single-page":!1,total:e.widgetObj.widgetParams[0].typeOptions.dataJson.total,"current-page":m.value,"onUpdate:currentPage":t[1]||(t[1]=c=>m.value=c),"page-size":V.value,"onUpdate:pageSize":t[2]||(t[2]=c=>V.value=c),onSizeChange:y,onCurrentChange:M},null,8,["total","current-page","page-size"])):S("",!0)])],64)}}},ke=ae(fe,[["__scopeId","data-v-52e1a8f3"]]);export{ke as default};
