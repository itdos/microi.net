import{_ as V,u as M,s as N,r as C,l as U,a as Z,m as K,n as D,b as Q,d as F,e as X,p as Y,f as $,q as ee,F as ae,k as te}from"./index-VdJnV-Xx.js";import{C as ie}from"./CommonSearch-D8QI6QXb.js";import"./useWidget-MIMwv8H2.js";import"./axiosInstance-jW9wSf4p.js";const le={__name:"bar-widget",props:{widgetObj:{type:Object,required:!0}},setup(r){var w,v,c,b,m,p,x,O;const W=M(),{curWrapper:J,dark:t}=N(W),e=r,o=C(null);let l=null;const T=U(()=>{var i;let s=(i=e.widgetObj.widgetParams[1])!=null&&i.value?40:0;return e.widgetObj.widgetOption.height-s+"px"}),a=C({});a.value={title:{show:!0,text:"",subtext:"",textStyle:{color:t.value?"#999":"#333",fontStyle:"normal",fontWeight:"bolder",fontFamily:"sans-serif",fontSize:18}},tooltip:{trigger:"axis",show:!0,axisPointer:{type:(w=e.widgetObj.widgetParams[3])==null?void 0:w.value,label:{backgroundColor:"#6a7985"}}},legend:{show:!0,type:"scroll",textStyle:{color:t.value?"#999":"#333"},data:[],orient:(v=e.widgetObj.widgetParams[8])==null?void 0:v.value,left:(c=e.widgetObj.widgetParams[9])==null?void 0:c.value},grid:{show:!1,left:"10%",right:"4%",bottom:"30px",containLabel:!1},toolbox:{show:!0,feature:{dataZoom:{yAxisIndex:"none"},dataView:{readOnly:!1},restore:{},saveAsImage:{}}},xAxis:{type:(b=e.widgetObj.widgetParams[17])!=null&&b.value?"value":"category",boundaryGap:!0,axisTick:{alignWithLabel:!0},axisLabel:{formatter:"{value} "+((m=e.widgetObj.widgetParams[4])==null?void 0:m.value),color:t.value?"#999":"#333"},data:[]},yAxis:{type:(p=e.widgetObj.widgetParams[17])!=null&&p.value?"category":"value",splitLine:{show:(x=e.widgetObj.widgetParams[15])==null?void 0:x.value},axisLabel:{formatter:"{value} "+((O=e.widgetObj.widgetParams[4])==null?void 0:O.value),color:t.value?"#999":"#333"},data:[]},series:[]},Z(()=>{window.addEventListener("resize",d)}),K(()=>{window.removeEventListener("resize",d)});const n=()=>{console.log("重置数据"),D(()=>{l&&l.dispose(),o.value&&(l=te(o.value),g())})},q=()=>{l.setOption(a.value)},g=()=>{var s,i,j,h,y,f,P,A,S,k,L,_,I,z;a.value.xAxis.type=(s=e.widgetObj.widgetParams[17])!=null&&s.value?"value":"category",a.value.yAxis.type=(i=e.widgetObj.widgetParams[17])!=null&&i.value?"category":"value",a.value.title.textStyle.color=t.value?"#999":"#333",a.value.legend.textStyle.color=t.value?"#999":"#333",a.value.xAxis.axisLabel.color=t.value?"#999":"#333",a.value.yAxis.axisLabel.color=t.value?"#999":"#333",a.value.tooltip.axisPointer.type=(j=e.widgetObj.widgetParams[3])==null?void 0:j.value,a.value.legend.orient=(h=e.widgetObj.widgetParams[8])==null?void 0:h.value,a.value.legend.left=(y=e.widgetObj.widgetParams[9])==null?void 0:y.value,a.value.title.text=(f=e.widgetObj.widgetParams[5])==null?void 0:f.value,a.value.title.subtext=(P=e.widgetObj.widgetParams[6])==null?void 0:P.value,a.value.legend.show=(A=e.widgetObj.widgetParams[7])==null?void 0:A.value,a.value.tooltip.show=(S=e.widgetObj.widgetParams[10])==null?void 0:S.value,a.value.tooltip.trigger=(k=e.widgetObj.widgetParams[11])==null?void 0:k.value,a.value.toolbox.show=(L=e.widgetObj.widgetParams[12])==null?void 0:L.value,a.value.xAxis.data=e.widgetObj.widgetParams[0].typeOptions.dataJson.xAxis,a.value.yAxis.data=e.widgetObj.widgetParams[0].typeOptions.dataJson.xAxis,a.value.xAxis.boundaryGap=(_=e.widgetObj.widgetParams[2])==null?void 0:_.value,a.value.yAxis.splitLine.show=(I=e.widgetObj.widgetParams[15])==null?void 0:I.value,a.value.series=[],a.value.legend.data=[],(z=e.widgetObj.widgetParams[0].typeOptions.dataJson.series)==null||z.forEach((u,se)=>{var E,B;const G={type:"bar",name:u.name,data:u.data,tooltip:{valueFormatter:function(H){var R;return H+" "+((R=e.widgetObj.widgetParams[4])==null?void 0:R.value)}},label:{show:(E=e.widgetObj.widgetParams[13])==null?void 0:E.value,position:(B=e.widgetObj.widgetParams[14])==null?void 0:B.value}};a.value.series.push(G),a.value.legend.data.push(u.name)}),q()},d=()=>{D(()=>{o.value&&l.resize()})};return Q([()=>e.widgetObj,()=>J.value,()=>t.value],()=>{n(),d()},{deep:!0}),(s,i)=>(F(),X(ae,null,[(F(),Y(ie,{widgetObj:r.widgetObj,searchIndex:1,pickerIndex:16,key:r.widgetObj.widgetOption.number,onSetData:g,onResetData:n},null,8,["widgetObj"])),$("div",{ref_key:"chartRef",ref:o,style:ee([{width:"100%"},{height:T.value}])},null,4)],64))}},ne=V(le,[["__scopeId","data-v-c6d12561"]]);export{ne as default};
