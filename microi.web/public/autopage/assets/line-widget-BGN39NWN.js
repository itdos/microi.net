import{_ as se,u as re,s as ne,r as d,c as ie,o as de,a as ue,n as K,i as ce,w as ge,b as v,d as i,e as O,f as ve,v as pe,g as N,h as T,j as G,F as j,k as H,l as _,m as q,p as Q,q as we,t as me,x as be}from"./index-CfICaLg9.js";import{u as he,g as fe}from"./useWidget-zuxP2hw3.js";const ye={class:"date-range"},xe={__name:"line-widget",props:{widgetObj:{type:Object,required:!0}},setup(P){var Y,C,E,D;const X=re(),{curWrapper:Z,dark:r}=ne(X),e=P,S=d((Y=e.widgetObj.widgetParams[0].typeOptions.dataJson)==null?void 0:Y.searchData),b=d(!1);d([]);const $=async(n,o,u)=>{if(n&&o.optionUrl){b.value=!0;let c={};try{const s=await fe(o.optionUrl+n,c);s&&s.length>0&&(S.value[u].options=s),b.value=!1}catch(s){console.error("Error fetching data:",s)}finally{b.value=!1}}},k=d(),z=d(!1),{loadRemoteData:A}=he(e.widgetObj,e.widgetObj.widgetParams[0].typeOptions.dataJson,k,z),V=async()=>{await A(),U()},h=d(null);let p=null;const ee=ie(()=>{var o;let n=(o=e.widgetObj.widgetParams[1])!=null&&o.value?40:0;return e.widgetObj.widgetOption.height-n+"px"}),a=d({});a.value={title:{show:!0,text:"",subtext:"",textStyle:{color:r.value?"#fff":"#333",fontStyle:"normal",fontWeight:"bolder",fontFamily:"sans-serif",fontSize:18}},tooltip:{trigger:"axis",show:!0,axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{show:!0,type:"scroll",textStyle:{color:r.value?"#999":"#333"},data:[],orient:(C=e.widgetObj.widgetParams[8])==null?void 0:C.value,left:(E=e.widgetObj.widgetParams[9])==null?void 0:E.value},grid:{show:!1,left:"10%",right:"4%",bottom:"30px",containLabel:!1},toolbox:{show:!0,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!0,axisTick:{alignWithLabel:!0},axisLabel:{color:r.value?"#999":"#333"},data:[]},yAxis:{type:"value",splitLine:{show:(D=e.widgetObj.widgetParams[15])==null?void 0:D.value},axisLabel:{formatter:"{value}",color:r.value?"#999":"#333"}},series:[]},de(()=>{ae(),le()}),ue(()=>{oe()});const ae=async()=>{await A(),R()},R=()=>{K(()=>{p&&p.dispose(),h.value&&(p=ce(h.value),U())})},te=()=>{p.setOption(a.value)},U=()=>{var n,o,u,c,s,f,y,x,w,m,t,g;a.value.title.textStyle.color=r.value?"#999":"#333",a.value.legend.textStyle.color=r.value?"#999":"#333",a.value.xAxis.axisLabel.color=r.value?"#999":"#333",a.value.yAxis.axisLabel.color=r.value?"#999":"#333",a.value.legend.orient=(n=e.widgetObj.widgetParams[8])==null?void 0:n.value,a.value.legend.left=(o=e.widgetObj.widgetParams[9])==null?void 0:o.value,a.value.title.text=(u=e.widgetObj.widgetParams[5])==null?void 0:u.value,a.value.title.subtext=(c=e.widgetObj.widgetParams[6])==null?void 0:c.value,a.value.legend.show=(s=e.widgetObj.widgetParams[7])==null?void 0:s.value,a.value.tooltip.show=(f=e.widgetObj.widgetParams[10])==null?void 0:f.value,a.value.tooltip.trigger=(y=e.widgetObj.widgetParams[11])==null?void 0:y.value,a.value.toolbox.show=(x=e.widgetObj.widgetParams[12])==null?void 0:x.value,a.value.xAxis.data=e.widgetObj.widgetParams[0].typeOptions.dataJson.xAxis,a.value.xAxis.boundaryGap=(w=e.widgetObj.widgetParams[2])==null?void 0:w.value,a.value.yAxis.splitLine.show=(m=e.widgetObj.widgetParams[15])==null?void 0:m.value,a.value.series=[],a.value.legend.data=[],(g=(t=e.widgetObj.widgetParams[0].typeOptions.dataJson)==null?void 0:t.series)==null||g.forEach((l,M)=>{var W,I,J,F;const B={type:"line",name:l.name,data:l.data,smooth:(W=e.widgetObj.widgetParams[3])==null?void 0:W.value,label:{show:(I=e.widgetObj.widgetParams[13])==null?void 0:I.value,position:(J=e.widgetObj.widgetParams[14])==null?void 0:J.value}};(F=e.widgetObj.widgetParams[4])!=null&&F.value&&(B.areaStyle={}),a.value.series.push(B),a.value.legend.data.push(l.name)}),te()},le=()=>{window.addEventListener("resize",L)},oe=()=>{window.removeEventListener("resize",L)},L=()=>{K(()=>{h.value&&p.resize()})};return ge([()=>e.widgetObj,()=>Z.value,()=>r.value],()=>{R(),L()},{deep:!0}),(n,o)=>{var w;const u=v("el-input"),c=v("el-option"),s=v("el-select"),f=v("el-date-picker"),y=v("el-button"),x=v("el-space");return i(),O(j,null,[ve(N("div",ye,[T(x,{wrap:""},{default:G(()=>{var m;return[(i(!0),O(j,null,H(S.value,(t,g)=>(i(),O(j,null,[t.type=="input"?(i(),_(u,{key:g,modelValue:t.value,"onUpdate:modelValue":l=>t.value=l,size:"small",placeholder:"请输入"+t.label,clearable:"",onKeyup:q(V,["enter"])},null,8,["modelValue","onUpdate:modelValue","placeholder"])):t.type=="select"?(i(),_(s,{class:"pagesearch",style:{"min-width":"120px"},key:g+"select",modelValue:t.value,"onUpdate:modelValue":l=>t.value=l,size:"small",placeholder:"请选择"+t.label,clearable:"",filterable:"",remote:"","remote-method":l=>$(l,t,g),loading:b.value,onKeyup:q(V,["enter"])},{default:G(()=>[(i(!0),O(j,null,H(t.options,(l,M)=>(i(),_(c,{value:l.value,label:l.label,key:M+l.value},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","remote-method","loading"])):Q("",!0)],64))),256)),(m=P.widgetObj.widgetParams[16])!=null&&m.value?(i(),_(f,{key:0,modelValue:k.value,"onUpdate:modelValue":o[0]||(o[0]=t=>k.value=t),size:"small","unlink-panels":"",type:"monthrange","range-separator":"至","start-placeholder":"起始年月","end-placeholder":"结束年月",format:"YYYY-MM","value-format":"YYYY-MM"},null,8,["modelValue"])):Q("",!0),T(y,{icon:we(me),size:"small",loading:z.value,circle:"",onClick:V},null,8,["icon","loading"])]}),_:1})],512),[[pe,(w=P.widgetObj.widgetParams[1])==null?void 0:w.value]]),N("div",{ref_key:"chartRef",ref:h,style:be([{width:"100%"},{height:ee.value}])},null,4)],64)}}},_e=se(xe,[["__scopeId","data-v-87d814ef"]]);export{_e as default};
