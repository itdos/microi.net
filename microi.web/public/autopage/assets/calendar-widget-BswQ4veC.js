import{u as v}from"./useWidget-7UKZkDzP.js";import{u as k,s as C,r as p,w as D,c as i,d as E,p as J,h as c,g,f as P,i as _,y as u,E as S}from"./index-C52r2N6b.js";const B=["onClick"],I={__name:"calendar-widget",props:{widgetObj:{type:Object,required:!0}},async setup(w){let r,l;const m=k(),{formData:f}=C(m),n=w,y=p(),O=p(!1),{loadRemoteData:b}=v(n.widgetObj,n.widgetObj.widgetParams[0].typeOptions.dataJson,y,O);[r,l]=D(()=>b()),await r,l();const h=e=>n.widgetObj.widgetParams[0].typeOptions.dataJson.findIndex(a=>a.date==e)>-1,x=e=>{var a,s;let t=n.widgetObj.widgetParams[0].typeOptions.dataJson.findIndex(d=>d.date==e);return((a=n.widgetObj.widgetParams[0].typeOptions.dataJson[t])==null?void 0:a.content)==null?"无事件":(s=n.widgetObj.widgetParams[0].typeOptions.dataJson[t])==null?void 0:s.content},j=e=>{var t;f.value.JsonObj.formConfig.link&&(S.emit("calendarSelDate",e),(t=window.parent)==null||t.postMessage({key:"calendarSelDate",value:e},"*"),console.log("触发日历事件总线，当前点击日期：",e))};return(e,t)=>{const a=i("el-badge"),s=i("el-tooltip"),d=i("el-calendar");return E(),J(d,null,{"date-cell":c(({data:o})=>[g(s,{"raw-content":!0,"show-after":200,content:x(o.day)},{default:c(()=>[P("div",{onClick:N=>j(o.day)},[g(a,{"is-dot":"",hidden:!h(o.day)},{default:c(()=>[_(u(o.day.split("-")[2]),1)]),_:2},1032,["hidden"]),_(" "+u(o.isSelected?"✔️":""),1)],8,B)]),_:2},1032,["content"])]),_:1})}}};export{I as default};
