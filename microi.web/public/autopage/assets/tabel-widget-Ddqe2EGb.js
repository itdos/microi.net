import{_ as Z,b as s,d as n,l as d,N as le,j as w,g as _,M as ne,z as Q,A as R,e as g,F as f,k as x,p as B,r as h,c as oe,y as re,f as se,v as de,h as D,m as X,q as ue,t as ie,x as ce}from"./index-DyLXfrdt.js";import{u as me,g as ge}from"./useWidget-DSWdr14G.js";const we={key:3,style:{"margin-left":"5px"}},be={__name:"RecursiveTableColumn",props:{column:{type:Object,required:!0},widgetObj:{type:Object,required:!0}},setup(e){return(S,U)=>{const u=s("el-tag"),P=s("el-progress"),b=s("el-rate"),Y=s("recursive-table-column",!0),V=s("el-table-column");return n(),d(V,{prop:e.column.prop,label:e.column.label,width:e.column.width,align:e.column.align},le({default:w(()=>[e.column.children?(n(!0),g(f,{key:0},x(e.column.children,(a,c)=>(n(),d(Y,{key:c,column:a,"widget-obj":e.widgetObj},null,8,["column","widget-obj"]))),128)):B("",!0)]),_:2},[e.column.children?void 0:{name:"header",fn:w(a=>[_("div",null,[(n(),d(ne(e.column.icon),{class:"icons"})),Q(" "+R(a.column.label),1)])]),key:"0"},e.column.children?void 0:{name:"default",fn:w(a=>{var c;return[_("div",null,[e.column.status_ui&&a.row.status_ui?(n(),d(u,{key:0,type:a.row.status_ui},{default:w(()=>[Q(R(a.row[e.column.prop]),1)]),_:2},1032,["type"])):e.column.progress_ui&&a.row.progress_ui?(n(),d(P,{key:1,"text-inside":!0,"stroke-width":(c=e.widgetObj.widgetParams[5])==null?void 0:c.value,status:a.row.progress_ui,percentage:a.row[e.column.prop]},null,8,["stroke-width","status","percentage"])):e.column.rate_ui?(n(),d(b,{key:2,"allow-half":"",disabled:"","show-score":"",modelValue:a.row[e.column.prop],"onUpdate:modelValue":J=>a.row[e.column.prop]=J},null,8,["modelValue","onUpdate:modelValue"])):(n(),g("span",we,R(a.row[e.column.prop]),1))])]}),key:"1"}]),1032,["prop","label","width","align"])}}},pe=Z(be,[["__scopeId","data-v-ea4e1344"]]),ye={class:"date-range"},ve={style:{"margin-top":"12px",display:"flex","justify-content":"flex-end"}},he={__name:"tabel-widget",props:{widgetObj:{type:Object,required:!0}},async setup(e){let S,U;const u=e,P=h(u.widgetObj.widgetParams[0].typeOptions.dataJson.searchData),b=h(!1);h([]);const Y=async(o,t,m)=>{if(o&&t.optionUrl){b.value=!0;let j={};try{const r=await ge(t.optionUrl+o,j);r&&r.length>0&&(P.value[m].options=r),b.value=!1}catch(r){console.error("Error fetching data:",r)}finally{b.value=!1}}},V=oe(()=>{var t;let o=10;return u.widgetObj.widgetParams[7]&&(o=(t=u.widgetObj.widgetParams[7])==null?void 0:t.value),o}),a=h(1),c=async o=>{a.value=1,await z()},J=async o=>{a.value=1,await z()},ee=async o=>{await z()},K=[];K.value=u.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData;const M=h(),q=h(!1),{loadRemoteData:z}=me(u.widgetObj,K.value,M,q,a);[S,U]=re(()=>z()),await S,U();const T=o=>o.map(t=>t.children?{...t,children:T(t.children)}:t),ae=({row:o,column:t,rowIndex:m,columnIndex:j})=>{var C;let r=(C=u.widgetObj.widgetParams[6])==null?void 0:C.value;if(!r)return{rowspan:1,colspan:1};let p=u.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData,N=u.widgetObj.widgetParams[0].typeOptions.dataJson.headerData.findIndex(y=>y.prop==r);if(j===N){const y=p[m-1];if(p[m+1],y&&y[r]===o[r])return{rowspan:0,colspan:0};let O=1;for(let v=m+1;v<p.length&&p[v][r]===o[r];v++)O++;return{rowspan:O,colspan:1}}};return(o,t)=>{var O,v,E,F,I,L,W,$,G,H;const m=s("el-input"),j=s("el-option"),r=s("el-select"),p=s("el-date-picker"),A=s("el-button"),N=s("el-space"),C=s("el-table"),y=s("el-pagination");return n(),g(f,null,[se(_("div",ye,[D(N,{wrap:""},{default:w(()=>[(n(!0),g(f,null,x(P.value,(l,k)=>(n(),g(f,null,[l.type=="input"?(n(),d(m,{key:k,modelValue:l.value,"onUpdate:modelValue":i=>l.value=i,size:"small",placeholder:"请输入"+l.label,clearable:"",onKeyup:X(c,["enter"])},null,8,["modelValue","onUpdate:modelValue","placeholder"])):l.type=="select"?(n(),d(r,{class:"pagesearch",style:{"min-width":"120px"},key:k+"select",modelValue:l.value,"onUpdate:modelValue":i=>l.value=i,size:"small",placeholder:"请选择"+l.label,clearable:"",filterable:"",remote:"","remote-method":i=>Y(i,l,k),loading:b.value,onKeyup:X(c,["enter"])},{default:w(()=>[(n(!0),g(f,null,x(l.options,(i,te)=>(n(),d(j,{value:i.value,label:i.label,key:te+i.value},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","remote-method","loading"])):B("",!0)],64))),256)),D(p,{modelValue:M.value,"onUpdate:modelValue":t[0]||(t[0]=l=>M.value=l),size:"small","unlink-panels":"",type:"monthrange","range-separator":"至","start-placeholder":"起始年月","end-placeholder":"结束年月",format:"YYYY-MM","value-format":"YYYY-MM"},null,8,["modelValue"]),D(A,{icon:ue(ie),size:"small",loading:q.value,circle:"",onClick:c},null,8,["icon","loading"])]),_:1})],512),[[de,(O=e.widgetObj.widgetParams[1])==null?void 0:O.value]]),D(C,{data:e.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData,stripe:(v=e.widgetObj.widgetParams[2])==null?void 0:v.value,border:(E=e.widgetObj.widgetParams[3])==null?void 0:E.value,size:(F=e.widgetObj.widgetParams[4])==null?void 0:F.value,"span-method":ae,"show-summary":(I=e.widgetObj.widgetParams[8])==null?void 0:I.value,style:ce({"--el-table-border-color":(L=e.widgetObj.widgetParams[9])==null?void 0:L.value}),"header-cell-style":{background:(W=e.widgetObj.widgetParams[10])==null?void 0:W.value,color:($=e.widgetObj.widgetParams[11])==null?void 0:$.value},"cell-style":{color:(G=e.widgetObj.widgetParams[12])==null?void 0:G.value}},{default:w(()=>[(n(!0),g(f,null,x(T(e.widgetObj.widgetParams[0].typeOptions.dataJson.headerData),(l,k)=>(n(),d(pe,{key:k,column:l,"widget-obj":e.widgetObj},null,8,["column","widget-obj"]))),128))]),_:1},8,["data","stripe","border","size","show-summary","style","header-cell-style","cell-style"]),_("div",ve,[e.widgetObj.widgetParams[7]&&((H=e.widgetObj.widgetParams[7])==null?void 0:H.value)!=-1?(n(),d(y,{key:0,layout:"prev, pager, next",background:"",size:"small","hide-on-single-page":!1,total:e.widgetObj.widgetParams[0].typeOptions.dataJson.total,"current-page":a.value,"onUpdate:currentPage":t[1]||(t[1]=l=>a.value=l),"page-size":V.value,"onUpdate:pageSize":t[2]||(t[2]=l=>V.value=l),onSizeChange:J,onCurrentChange:ee},null,8,["total","current-page","page-size"])):B("",!0)])],64)}}},Oe=Z(he,[["__scopeId","data-v-dac496c5"]]);export{Oe as default};
