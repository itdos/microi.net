const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-BvwMQxGN.js","./index-Bp6J_suO.js","./index-n7uayP8m.css","./vue.runtime.esm-bundler-BeFixcck.js","./index-D1EPsmR_.js","./index-8EJ95Xpw.js"])))=>i.map(i=>d[i]);
import{u as O,s as v,L as C,j as u,r,w as E,d as m,e as j,l as L,m as b,M as D,z as i,A as s}from"./index-Bp6J_suO.js";import{u as I}from"./useWidget-B4QL9j6Z.js";import"./axiosInstance-CdbGeMaR.js";const S={__name:"office-widget",props:{widgetObj:{type:Object,required:!0}},async setup(l){let c,d;const p=O(),{formData:a,curWidget:U,components:A}=v(p),o=l,n=C(),g=u(()=>{var f;const t=new URLSearchParams(window.parent.location.hash).get("filePath");return console.log("iframePath",t),t?decodeURIComponent(t):a.value.filePath?(console.log("formData.value.filePath",a.value.filePath),decodeURIComponent(a.value.filePath)):n.query.filePath?decodeURIComponent(n.query.filePath):decodeURIComponent((f=o.widgetObj.widgetParams[0].typeOptions.dataJson)==null?void 0:f.filePath)}),h=r(),_=u(()=>{let e=n.query.filePath;return e||(e=o.widgetObj.widgetParams[0].typeOptions.dataJson.filePath),e&&e.toLowerCase().includes("doc")?i(()=>s(()=>import("./index-BvwMQxGN.js").then(t=>t.i),__vite__mapDeps([0,1,2,3]),import.meta.url)):e&&e.toLowerCase().includes("xls")?i(()=>s(()=>import("./index-D1EPsmR_.js").then(t=>t.i),__vite__mapDeps([4,1,2,3]),import.meta.url)):e&&e.toLowerCase().includes("pdf")?i(()=>s(()=>import("./index-8EJ95Xpw.js").then(t=>t.i),__vite__mapDeps([5,1,2,3]),import.meta.url)):null}),P=r(),w=r(!1),{loadRemoteData:R}=I(o.widgetObj,o.widgetObj.widgetParams[0].typeOptions.dataJson,P,w);[c,d]=E(()=>R()),await c,d();const y=()=>{console.log("office-widget 已加载完成")};return(e,t)=>(m(),j("div",{class:"office-widget",ref_key:"officeWidgetRef",ref:h},[(m(),L(D(_.value),{class:"office-component",src:g.value,onRendered:y,style:b({height:l.widgetObj.widgetOption.height+"px"})},null,40,["src","style"]))],512))}};export{S as default};
