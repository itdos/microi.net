const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PieChart-D-FLJliN.js","./index-B6BEyYNr.js","./index-Ckt8JT7p.css"])))=>i.map(i=>d[i]);
import{_ as ne,r as g,l as oe,c as r,d as l,p as s,L as ie,h as y,f as A,I as ue,i as ae,y as T,e as w,F as f,z as x,x as re,q as se,A as J,J as ce,K as me,a as ge,w as we,t as be,v as pe,g as q,M as le,N as he}from"./index-B6BEyYNr.js";import{u as ye,g as ve}from"./useWidget-DA8VqTGc.js";const fe={key:2,style:{display:"flex","justify-content":"center","align-items":"center"}},Oe={key:4,style:{"margin-left":"5px"}},je={__name:"RecursiveTableColumn",props:{column:{type:Object,required:!0},widgetObj:{type:Object,required:!0}},setup(e){var b,u,P;const S=ce(()=>me(()=>import("./PieChart-D-FLJliN.js"),__vite__mapDeps([0,1,2]),import.meta.url)),O=e,d=g((b=O.widgetObj.widgetParams[14])==null?void 0:b.value),j=g((u=O.widgetObj.widgetParams[15])==null?void 0:u.value),B=g((P=O.widgetObj.widgetParams[16])==null?void 0:P.value),U=oe(()=>p=>({datasets:[{data:[p.chart_ui,100-p.chart_ui],backgroundColor:[j.value,"#c8c8c820"],borderColor:[B.value,"#c8c8c8"],borderWidth:1}]}));return(p,W)=>{const I=r("el-tag"),M=r("el-space"),C=r("el-progress"),R=r("el-rate"),Y=r("recursive-table-column",!0),E=r("el-table-column");return l(),s(E,{prop:e.column.prop,label:e.column.label,width:e.column.width,align:e.column.align},ie({default:y(()=>[e.column.children?(l(!0),w(f,{key:0},x(e.column.children,(n,a)=>(l(),s(Y,{key:a,column:n,"widget-obj":e.widgetObj},null,8,["column","widget-obj"]))),128)):J("",!0)]),_:2},[e.column.children?void 0:{name:"header",fn:y(n=>[A("div",null,[(l(),s(ue(e.column.icon),{class:"icons"})),ae(" "+T(n.column.label),1)])]),key:"0"},e.column.children?void 0:{name:"default",fn:y(n=>{var a;return[A("div",null,[e.column.status_ui&&n.row.status_ui?(l(),s(M,{key:0},{default:y(()=>[(l(!0),w(f,null,x(n.row[e.column.prop].split(","),(t,i)=>(l(),s(I,{key:i,type:n.row.status_ui},{default:y(()=>[ae(T(t),1)]),_:2},1032,["type"]))),128))]),_:2},1024)):e.column.progress_ui&&n.row.progress_ui?(l(),s(C,{key:1,"text-inside":!0,"stroke-width":(a=e.widgetObj.widgetParams[5])==null?void 0:a.value,status:n.row.progress_ui,percentage:n.row[e.column.prop]},null,8,["stroke-width","status","percentage"])):e.column.chart_ui&&n.row.chart_ui?(l(),w("div",fe,[e.column.chart_ui&&n.row.chart_ui?(l(),s(re(S),{key:0,"chart-data":U.value(n.row),style:se({width:d.value+"px"})},null,8,["chart-data","style"])):J("",!0)])):e.column.rate_ui?(l(),s(R,{key:3,"allow-half":"",disabled:"","show-score":"",modelValue:n.row[e.column.prop],"onUpdate:modelValue":t=>n.row[e.column.prop]=t},null,8,["modelValue","onUpdate:modelValue"])):(l(),w("span",Oe,T(n.row[e.column.prop]),1))])]}),key:"1"}]),1032,["prop","label","width","align"])}}},Pe=ne(je,[["__scopeId","data-v-d8beb3c8"]]),ke={class:"date-range"},_e={style:{"margin-top":"12px",display:"flex","justify-content":"flex-end"}},Ve={__name:"tabel-widget",props:{widgetObj:{type:Object,required:!0}},async setup(e){let S,O;const d=e,j=g(!1);g([]);const B=async(a,t,i)=>{if(a&&t.remote&&t.optionUrl){j.value=!0;let D={};try{const o=await ve(t.optionUrl+a,D);o&&o.length>0&&(d.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[i].options=o),j.value=!1}catch(o){console.error("Error fetching data:",o)}finally{j.value=!1}}},U=oe(()=>{var t;let a=10;return d.widgetObj.widgetParams[7]&&(a=(t=d.widgetObj.widgetParams[7])==null?void 0:t.value),a}),b=g(1),u=g({});ge(()=>{var a;(a=d.widgetObj.widgetParams[0].typeOptions.dataJson.searchData)==null||a.forEach((t,i)=>{u.value[i]=t.value})});const P=async()=>{const a={...u.value};for(const[t,i]of Object.entries(a))d.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[t]&&(d.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[t].value=i);await Y()},p=async a=>{b.value=1,await P()},W=async a=>{b.value=1,await P()},I=async a=>{await P()},M=[];M.value=d.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData;const C=g(),R=g(!1),{loadRemoteData:Y}=ye(d.widgetObj,M.value,C,R,b);[S,O]=we(()=>Y()),await S,O();const E=a=>a.map(t=>t.children?{...t,children:E(t.children)}:t),n=({row:a,column:t,rowIndex:i,columnIndex:D})=>{var K;let o=(K=d.widgetObj.widgetParams[6])==null?void 0:K.value;if(!o)return{rowspan:1,colspan:1};let k=d.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData,L=d.widgetObj.widgetParams[0].typeOptions.dataJson.headerData.findIndex(_=>_.prop==o);if(D===L){const _=k[i-1];if(k[i+1],_&&_[o]===a[o])return{rowspan:0,colspan:0};let z=1;for(let V=i+1;V<k.length&&k[V][o]===a[o];V++)z++;return{rowspan:z,colspan:1}}};return(a,t)=>{var z,V,F,G,H,Q,X,Z,ee,te;const i=r("el-input"),D=r("el-option"),o=r("el-select"),k=r("el-date-picker"),$=r("el-button"),L=r("el-space"),K=r("el-table"),_=r("el-pagination");return l(),w(f,null,[be(A("div",ke,[q(L,{wrap:""},{default:y(()=>{var h,N;return[(l(!0),w(f,null,x((h=e.widgetObj.widgetParams[0].typeOptions.dataJson)==null?void 0:h.searchData,(c,v)=>(l(),w(f,null,[c.type=="input"?(l(),s(i,{key:v,modelValue:u.value[v],"onUpdate:modelValue":m=>u.value[v]=m,size:"small",placeholder:"请输入"+c.label,clearable:"",onKeyup:le(p,["enter"])},null,8,["modelValue","onUpdate:modelValue","placeholder"])):c.type=="select"?(l(),s(o,{class:"pagesearch",style:{"min-width":"120px"},key:v+"select",modelValue:u.value[v],"onUpdate:modelValue":m=>u.value[v]=m,onChange:p,size:"small",placeholder:"请选择"+c.label,clearable:"",filterable:"",remote:c.remote,"remote-method":m=>B(m,c,v),loading:j.value,onKeyup:le(p,["enter"])},{default:y(()=>[(l(!0),w(f,null,x(c.options,(m,de)=>(l(),s(D,{value:m.value,label:m.label,key:de+m.value},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","remote","remote-method","loading"])):J("",!0)],64))),256)),(N=e.widgetObj.widgetParams[13])!=null&&N.value?(l(),s(k,{key:0,modelValue:C.value,"onUpdate:modelValue":t[0]||(t[0]=c=>C.value=c),size:"small","unlink-panels":"",type:"monthrange","range-separator":"至","start-placeholder":"起始年月","end-placeholder":"结束年月",format:"YYYY-MM","value-format":"YYYY-MM"},null,8,["modelValue"])):J("",!0),q($,{icon:re(he),size:"small",loading:R.value,circle:"",onClick:p},null,8,["icon","loading"])]}),_:1})],512),[[pe,(z=e.widgetObj.widgetParams[1])==null?void 0:z.value]]),q(K,{data:e.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData,stripe:(V=e.widgetObj.widgetParams[2])==null?void 0:V.value,border:(F=e.widgetObj.widgetParams[3])==null?void 0:F.value,size:(G=e.widgetObj.widgetParams[4])==null?void 0:G.value,"span-method":n,"show-summary":(H=e.widgetObj.widgetParams[8])==null?void 0:H.value,style:se({"--el-table-border-color":(Q=e.widgetObj.widgetParams[9])==null?void 0:Q.value}),"header-cell-style":{background:(X=e.widgetObj.widgetParams[10])==null?void 0:X.value,color:(Z=e.widgetObj.widgetParams[11])==null?void 0:Z.value},"cell-style":{color:(ee=e.widgetObj.widgetParams[12])==null?void 0:ee.value}},{default:y(()=>[(l(!0),w(f,null,x(E(e.widgetObj.widgetParams[0].typeOptions.dataJson.headerData),(h,N)=>(l(),s(Pe,{key:N,column:h,"widget-obj":e.widgetObj},null,8,["column","widget-obj"]))),128))]),_:1},8,["data","stripe","border","size","show-summary","style","header-cell-style","cell-style"]),A("div",_e,[e.widgetObj.widgetParams[7]&&((te=e.widgetObj.widgetParams[7])==null?void 0:te.value)!=-1?(l(),s(_,{key:0,layout:"prev, pager, next",background:"",size:"small","hide-on-single-page":!1,total:e.widgetObj.widgetParams[0].typeOptions.dataJson.total,"current-page":b.value,"onUpdate:currentPage":t[1]||(t[1]=h=>b.value=h),"page-size":U.value,"onUpdate:pageSize":t[2]||(t[2]=h=>U.value=h),onSizeChange:W,onCurrentChange:I},null,8,["total","current-page","page-size"])):J("",!0)])],64)}}},ze=ne(Ve,[["__scopeId","data-v-2702e969"]]);export{ze as default};
