import{_ as $,r as b,y as ee,c as y,b as i,d as n,e as f,f as ae,v as te,g as V,h as w,j as c,F as O,k as S,l as p,m as x,p as K,q as le,t as oe,x as _,N as se,A as ne,M as R}from"./index-DlsyjTHd.js";import{u as re,g as de}from"./useWidget-DNrzTSHA.js";const ie={class:"date-range"},ue={__name:"statistic-widget",props:{widgetObj:{type:Object,required:!0}},async setup(u){let C,D;const e=u,j=b(!1);b([]);const A=async(a,t,l)=>{if(a&&t.optionUrl){j.value=!0;let g={};try{const m=await de(t.optionUrl+a,g);m&&m.length>0&&(e.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[l].options=m),j.value=!1}catch(m){console.error("Error fetching data:",m)}finally{j.value=!1}}},v=b({}),P=async a=>{const t={...v.value};for(const[l,g]of Object.entries(t))e.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[l]&&(e.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[l].value=g);await J()},k=b(),z=b(!1),{loadRemoteData:J}=re(e.widgetObj,e.widgetObj.widgetParams[0].typeOptions.dataJson,k,z);[C,D]=ee(()=>J()),await C,D();const E=y(()=>{var a,t;return{backgroundColor:(a=e.widgetObj.widgetParams[2])==null?void 0:a.value,padding:(t=e.widgetObj.widgetParams[3])==null?void 0:t.value}}),F=y(()=>{var a,t,l,g;return{fontSize:(a=e.widgetObj.widgetParams[7])==null?void 0:a.value,fontWeight:(t=e.widgetObj.widgetParams[8])==null?void 0:t.value,color:(l=e.widgetObj.widgetParams[9])==null?void 0:l.value,margin:(g=e.widgetObj.widgetParams[10])==null?void 0:g.value}}),L=y(()=>{var a,t,l;return{fontSize:(a=e.widgetObj.widgetParams[11])==null?void 0:a.value,fontWeight:(t=e.widgetObj.widgetParams[12])==null?void 0:t.value,color:(l=e.widgetObj.widgetParams[13])==null?void 0:l.value}}),Y=y(()=>{var a,t;return{color:(a=e.widgetObj.widgetParams[15])==null?void 0:a.value,fontSize:(t=e.widgetObj.widgetParams[16])==null?void 0:t.value}}),q=y(()=>{var a;return(a=e.widgetObj.widgetParams[0].typeOptions.dataJson)!=null&&a.data?e.widgetObj.widgetParams[0].typeOptions.dataJson.data:e.widgetObj.widgetParams[0].typeOptions.dataJson});return(a,t)=>{var M;const l=i("el-input"),g=i("el-option"),m=i("el-select"),G=i("el-date-picker"),H=i("el-button"),Q=i("el-space"),U=i("el-icon"),T=i("el-statistic"),X=i("el-col"),Z=i("el-row");return n(),f(O,null,[ae(V("div",ie,[w(Q,{wrap:""},{default:c(()=>{var r;return[(n(!0),f(O,null,S(e.widgetObj.widgetParams[0].typeOptions.dataJson.searchData,(o,d)=>(n(),f(O,null,[o.type=="input"?(n(),p(l,{key:d,modelValue:v.value[d],"onUpdate:modelValue":s=>v.value[d]=s,size:"small",placeholder:"请输入"+o.label,clearable:"",onKeyup:x(P,["enter"])},null,8,["modelValue","onUpdate:modelValue","placeholder"])):o.type=="select"?(n(),p(m,{class:"pagesearch",style:{"min-width":"120px"},key:d+"select",modelValue:v.value[d],"onUpdate:modelValue":s=>v.value[d]=s,size:"small",placeholder:"请选择"+o.label,clearable:"",filterable:"",remote:"","remote-method":s=>A(s,o,d),loading:j.value,onKeyup:x(P,["enter"])},{default:c(()=>[(n(!0),f(O,null,S(o.options,(s,h)=>(n(),p(g,{value:s.value,label:s.label,key:h+s.value},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","remote-method","loading"])):K("",!0)],64))),256)),(r=u.widgetObj.widgetParams[19])!=null&&r.value?(n(),p(G,{key:0,modelValue:k.value,"onUpdate:modelValue":t[0]||(t[0]=o=>k.value=o),size:"small","unlink-panels":"",type:"monthrange","range-separator":"至","start-placeholder":"起始年月","end-placeholder":"结束年月",format:"YYYY-MM","value-format":"YYYY-MM"},null,8,["modelValue"])):K("",!0),w(H,{icon:le(oe),size:"small",loading:z.value,circle:"",onClick:P},null,8,["icon","loading"])]}),_:1})],512),[[te,(M=u.widgetObj.widgetParams[18])==null?void 0:M.value]]),w(Z,{style:{width:"100%"}},{default:c(()=>[(n(!0),f(O,null,S(q.value,(r,o)=>{var d;return n(),p(X,{key:o,class:"el-col",span:(d=u.widgetObj.widgetParams[1])==null?void 0:d.value,style:_(E.value)},{default:c(()=>{var s,h,B,I,N,W;return[w(T,{style:_([{backgroundColor:r.bgColor?r.bgColor:(h=(s=u.widgetObj.widgetParams[4])==null?void 0:s.value)==null?void 0:h.split(",")[o>7?0:o]},{padding:(B=u.widgetObj.widgetParams[5])==null?void 0:B.value},{borderRadius:(I=u.widgetObj.widgetParams[6])==null?void 0:I.value},{backgroundImage:r.bgImage?r.bgImage:"url("+((N=u.widgetObj.widgetParams[17])==null?void 0:N.value)+")"}]),"value-style":L.value,value:r.value},se({title:c(()=>[V("div",{style:_(F.value)},[V("span",null,ne(r.name),1)],4)]),_:2},[((W=u.widgetObj.widgetParams[14])==null?void 0:W.value)=="prefix"?{name:"prefix",fn:c(()=>[w(U,{style:_(Y.value)},{default:c(()=>[(n(),p(R(r.icon)))]),_:2},1032,["style"])]),key:"0"}:{name:"suffix",fn:c(()=>[w(U,{style:_(Y.value)},{default:c(()=>[(n(),p(R(r.icon)))]),_:2},1032,["style"])]),key:"1"}]),1032,["style","value-style","value"])]}),_:2},1032,["span","style"])}),128))]),_:1})],64)}}},me=$(ue,[["__scopeId","data-v-71b6fd6b"]]);export{me as default};
