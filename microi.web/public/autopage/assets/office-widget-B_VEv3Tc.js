const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DKyLq4vQ.js","assets/index-h4SsnfnM.js","assets/index-BRSaBMef.css","assets/vue.runtime.esm-bundler-BGNx8AtJ.js","assets/index-CILy_1yA.js","assets/index-DVgrZAeh.js"])))=>i.map(i=>d[i]);
import{u as O,s as v,N as C,l as u,r,w as E,d as p,e as b,p as j,q as D,O as I,B as i,C as s}from"./index-h4SsnfnM.js";import{u as L}from"./useWidget-DfAz8fiY.js";import"./axiosInstance-Bfq04G9l.js";const B={__name:"office-widget",props:{widgetObj:{type:Object,required:!0}},async setup(c){let l,d;const m=O(),{formData:a,curWidget:U,components:q}=v(m),o=c,n=C(),g=u(()=>{var f;const t=new URLSearchParams(window.parent.location.hash).get("filePath");return console.log("iframePath",t),t?decodeURIComponent(t):a.value.filePath?(console.log("formData.value.filePath",a.value.filePath),decodeURIComponent(a.value.filePath)):n.query.filePath?decodeURIComponent(n.query.filePath):decodeURIComponent((f=o.widgetObj.widgetParams[0].typeOptions.dataJson)==null?void 0:f.filePath)}),h=r(),_=u(()=>{let e=n.query.filePath;return e||(e=o.widgetObj.widgetParams[0].typeOptions.dataJson.filePath),e&&e.toLowerCase().includes("doc")?i(()=>s(()=>import("./index-DKyLq4vQ.js").then(t=>t.i),__vite__mapDeps([0,1,2,3]))):e&&e.toLowerCase().includes("xls")?i(()=>s(()=>import("./index-CILy_1yA.js").then(t=>t.i),__vite__mapDeps([4,1,2,3]))):e&&e.toLowerCase().includes("pdf")?i(()=>s(()=>import("./index-DVgrZAeh.js").then(t=>t.i),__vite__mapDeps([5,1,2,3]))):null}),P=r(),w=r(!1),{loadRemoteData:R}=L(o.widgetObj,o.widgetObj.widgetParams[0].typeOptions.dataJson,P,w);[l,d]=E(()=>R()),await l,d();const y=()=>{console.log("office-widget 已加载完成")};return(e,t)=>(p(),b("div",{class:"office-widget",ref_key:"officeWidgetRef",ref:h},[(p(),j(I(_.value),{class:"office-component",src:g.value,onRendered:y,style:D({height:c.widgetObj.widgetOption.height+"px"})},null,40,["src","style"]))],512))}};export{B as default};
