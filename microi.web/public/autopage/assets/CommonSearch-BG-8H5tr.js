import{_ as K,r as w,a as F,j as L,w as R,c as p,p as q,v as A,d as r,e as h,g as J,h as C,F as f,x as Y,l as y,O as U,y as x,q as W,P as G}from"./index-tPSmL0Tj.js";import{u as H}from"./useWidget-Cwn6TFSu.js";import{g as Q}from"./axiosInstance-Bue43AbA.js";const T={class:"date-range"},X={__name:"CommonSearch",props:{widgetObj:{type:Object,required:!0},searchIndex:{type:Number,default:0},pickerIndex:{type:Number,default:0},currentPage:{type:Number,default:-1}},emits:["setData","resetData"],async setup(i,{emit:M}){let O,_;const a=i,m=w(!1),j=M,I=async(l,e,t)=>{if(l&&e.remote&&e.optionUrl){m.value=!0;let n={};try{const d=await Q(e.optionUrl+l,n);d&&d.length>0&&(a.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[t].options=d),m.value=!1}catch(d){console.error("Error fetching data:",d)}finally{m.value=!1}}},u=w({});F(async()=>{var l;(l=a.widgetObj.widgetParams[0].typeOptions.dataJson.searchData)==null||l.forEach((e,t)=>{u.value[t]=e.value}),await v(),j("resetData","")});const g=async l=>{const e={...u.value};for(const[t,n]of Object.entries(e))a.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[t]&&(a.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[t].value=n);await v(),j("setData","")},b=w(),P=w(!1),N=L(()=>{var l,e,t,n;return(l=a.widgetObj.widgetParams[0].typeOptions.dataJson)!=null&&l.data?(e=a.widgetObj.widgetParams[0].typeOptions.dataJson)==null?void 0:e.data:(t=a.widgetObj.widgetParams[0].typeOptions.dataJson)!=null&&t.bodyData?(n=a.widgetObj.widgetParams[0].typeOptions.dataJson)==null?void 0:n.bodyData:a.widgetObj.widgetParams[0].typeOptions.dataJson}),{loadRemoteData:v}=H(a.widgetObj,N,b,P,a.currentPage);return[O,_]=R(()=>v()),await O,_(),(l,e)=>{var V;const t=p("el-input"),n=p("el-option"),d=p("el-select"),z=p("el-date-picker"),S=p("el-button"),B=p("el-space");return q((r(),h("div",T,[J(B,{wrap:""},{default:C(()=>{var D,k;return[(r(!0),h(f,null,Y((D=i.widgetObj.widgetParams[0].typeOptions.dataJson)==null?void 0:D.searchData,(o,c)=>(r(),h(f,null,[o.type=="input"?(r(),y(t,{key:c,modelValue:u.value[c],"onUpdate:modelValue":s=>u.value[c]=s,size:"small",placeholder:"请输入"+o.label,clearable:"",onKeyup:U(g,["enter"])},null,8,["modelValue","onUpdate:modelValue","placeholder"])):o.type=="select"?(r(),y(d,{class:"pagesearch",style:{"min-width":"120px"},key:c+"select",modelValue:u.value[c],"onUpdate:modelValue":s=>u.value[c]=s,onChange:g,size:"small",placeholder:"请选择"+o.label,clearable:"",filterable:"",remote:o.remote,"remote-method":s=>I(s,o,c),loading:m.value,onKeyup:U(g,["enter"])},{default:C(()=>[(r(!0),h(f,null,Y(o.options,(s,E)=>(r(),y(n,{value:s.value,label:s.label,key:E+s.value},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","remote","remote-method","loading"])):x("",!0)],64))),256)),(k=i.widgetObj.widgetParams[i.pickerIndex])!=null&&k.value?(r(),y(z,{key:0,modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=o=>b.value=o),size:"small","unlink-panels":"",type:"monthrange","range-separator":"至","start-placeholder":"起始年月","end-placeholder":"结束年月",format:"YYYY-MM","value-format":"YYYY-MM"},null,8,["modelValue"])):x("",!0),J(S,{icon:W(G),size:"small",loading:P.value,circle:"",onClick:g},null,8,["icon","loading"])]}),_:1})],512)),[[A,(V=i.widgetObj.widgetParams[i.searchIndex])==null?void 0:V.value]])}}},ae=K(X,[["__scopeId","data-v-c4cc9d16"]]);export{ae as C};
