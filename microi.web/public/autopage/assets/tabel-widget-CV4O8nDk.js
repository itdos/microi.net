const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PieChart-CA9gH_DT.js","./index-tPSmL0Tj.js","./index-92pQ9dre.css"])))=>i.map(i=>d[i]);
import{_ as ne,r as b,j as oe,c as o,d as l,l as s,N as ie,h as i,f as z,M as ue,i as ae,t as I,e as p,F as O,x,g as N,q as re,m as se,y as S,z as ce,A as me,a as ge,w as we,p as be,v as pe,O as le,P as ve}from"./index-tPSmL0Tj.js";import{u as ye}from"./useWidget-Cwn6TFSu.js";import{g as he}from"./axiosInstance-Bue43AbA.js";const fe={key:2,style:{display:"flex","justify-content":"center","align-items":"center"}},Oe=["innerHTML"],je={__name:"RecursiveTableColumn",props:{column:{type:Object,required:!0},widgetObj:{type:Object,required:!0}},setup(e){var v,c,P;const J=ce(()=>me(()=>import("./PieChart-CA9gH_DT.js"),__vite__mapDeps([0,1,2]),import.meta.url)),u=e,d=b((v=u.widgetObj.widgetParams[14])==null?void 0:v.value),j=b((c=u.widgetObj.widgetParams[15])==null?void 0:c.value),A=b((P=u.widgetObj.widgetParams[16])==null?void 0:P.value),U=oe(()=>m=>({labels:[m[u.column.label]],datasets:[{data:[m[u.column.label],100-m[u.column.label]],backgroundColor:[j.value,"#c8c8c820"],borderColor:[A.value,"#c8c8c8"],borderWidth:1}]}));return(m,W)=>{const B=o("el-tag"),M=o("el-space"),C=o("el-progress"),R=o("el-tooltip"),Y=o("el-rate"),T=o("recursive-table-column",!0),K=o("el-table-column");return l(),s(K,{prop:e.column.prop,label:e.column.label,width:e.column.width,align:e.column.align},ie({default:i(()=>[e.column.children?(l(!0),p(O,{key:0},x(e.column.children,(t,a)=>(l(),s(T,{key:a,column:t,"widget-obj":e.widgetObj},null,8,["column","widget-obj"]))),128)):S("",!0)]),_:2},[e.column.children?void 0:{name:"header",fn:i(t=>[z("div",null,[(l(),s(ue(e.column.icon),{class:"icons"})),ae(" "+I(t.column.label),1)])]),key:"0"},e.column.children?void 0:{name:"default",fn:i(t=>{var a;return[z("div",null,[e.column.status_ui&&t.row.status_ui?(l(),s(M,{key:0},{default:i(()=>[(l(!0),p(O,null,x(t.row[e.column.prop].split(","),(n,h)=>(l(),s(B,{key:h,type:t.row.status_ui},{default:i(()=>[ae(I(n),1)]),_:2},1032,["type"]))),128))]),_:2},1024)):e.column.progress_ui&&t.row.progress_ui?(l(),s(C,{key:1,"text-inside":!0,"stroke-width":(a=e.widgetObj.widgetParams[5])==null?void 0:a.value,status:t.row.progress_ui,percentage:t.row[e.column.prop]},null,8,["stroke-width","status","percentage"])):e.column.chart_ui?(l(),p("div",fe,[N(R,{placement:"top","show-after":500},{content:i(()=>[z("div",null,I(t.row[e.column.prop])+"%",1)]),default:i(()=>[e.column.chart_ui?(l(),s(re(J),{key:0,"chart-data":U.value(t.row),style:se({width:d.value+"px"})},null,8,["chart-data","style"])):S("",!0)]),_:2},1024)])):e.column.rate_ui?(l(),s(Y,{key:3,"allow-half":"",disabled:"","show-score":"",modelValue:t.row[e.column.prop],"onUpdate:modelValue":n=>t.row[e.column.prop]=n},null,8,["modelValue","onUpdate:modelValue"])):(l(),p("span",{key:4,innerHTML:t.row[e.column.prop],style:{"margin-left":"5px"}},null,8,Oe))])]}),key:"1"}]),1032,["prop","label","width","align"])}}},Pe=ne(je,[["__scopeId","data-v-af0dfbd6"]]),ke={class:"date-range"},_e={style:{"margin-top":"12px",display:"flex","justify-content":"flex-end"}},Ve={__name:"tabel-widget",props:{widgetObj:{type:Object,required:!0}},async setup(e){let J,u;const d=e,j=b(!1);b([]);const A=async(t,a,n)=>{if(t&&a.remote&&a.optionUrl){j.value=!0;let h={};try{const r=await he(a.optionUrl+t,h);r&&r.length>0&&(d.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[n].options=r),j.value=!1}catch(r){console.error("Error fetching data:",r)}finally{j.value=!1}}},U=oe(()=>{var a;let t=10;return d.widgetObj.widgetParams[7]&&(t=(a=d.widgetObj.widgetParams[7])==null?void 0:a.value),t}),v=b(1),c=b({});ge(()=>{var t;(t=d.widgetObj.widgetParams[0].typeOptions.dataJson.searchData)==null||t.forEach((a,n)=>{c.value[n]=a.value})});const P=async()=>{const t={...c.value};for(const[a,n]of Object.entries(t))d.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[a]&&(d.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[a].value=n);await Y()},m=async t=>{v.value=1,await P()},W=async t=>{v.value=1,await P()},B=async t=>{await P()},M=[];M.value=d.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData;const C=b(),R=b(!1),{loadRemoteData:Y}=ye(d.widgetObj,M.value,C,R,v);[J,u]=we(()=>Y()),await J,u();const T=t=>t.map(a=>a.children?{...a,children:T(a.children)}:a),K=({row:t,column:a,rowIndex:n,columnIndex:h})=>{var E;let r=(E=d.widgetObj.widgetParams[6])==null?void 0:E.value;if(!r)return{rowspan:1,colspan:1};let k=d.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData,q=d.widgetObj.widgetParams[0].typeOptions.dataJson.headerData.findIndex(_=>_.prop==r);if(h===q){const _=k[n-1];if(k[n+1],_&&_[r]===t[r])return{rowspan:0,colspan:0};let D=1;for(let V=n+1;V<k.length&&k[V][r]===t[r];V++)D++;return{rowspan:D,colspan:1}}};return(t,a)=>{var D,V,F,H,G,Q,X,Z,ee,te;const n=o("el-input"),h=o("el-option"),r=o("el-select"),k=o("el-date-picker"),$=o("el-button"),q=o("el-space"),E=o("el-table"),_=o("el-pagination");return l(),p(O,null,[be(z("div",ke,[N(q,{wrap:""},{default:i(()=>{var y,L;return[(l(!0),p(O,null,x((y=e.widgetObj.widgetParams[0].typeOptions.dataJson)==null?void 0:y.searchData,(g,f)=>(l(),p(O,null,[g.type=="input"?(l(),s(n,{key:f,modelValue:c.value[f],"onUpdate:modelValue":w=>c.value[f]=w,size:"small",placeholder:"请输入"+g.label,clearable:"",onKeyup:le(m,["enter"])},null,8,["modelValue","onUpdate:modelValue","placeholder"])):g.type=="select"?(l(),s(r,{class:"pagesearch",style:{"min-width":"120px"},key:f+"select",modelValue:c.value[f],"onUpdate:modelValue":w=>c.value[f]=w,onChange:m,size:"small",placeholder:"请选择"+g.label,clearable:"",filterable:"",remote:g.remote,"remote-method":w=>A(w,g,f),loading:j.value,onKeyup:le(m,["enter"])},{default:i(()=>[(l(!0),p(O,null,x(g.options,(w,de)=>(l(),s(h,{value:w.value,label:w.label,key:de+w.value},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","remote","remote-method","loading"])):S("",!0)],64))),256)),(L=e.widgetObj.widgetParams[13])!=null&&L.value?(l(),s(k,{key:0,modelValue:C.value,"onUpdate:modelValue":a[0]||(a[0]=g=>C.value=g),size:"small","unlink-panels":"",type:"monthrange","range-separator":"至","start-placeholder":"起始年月","end-placeholder":"结束年月",format:"YYYY-MM","value-format":"YYYY-MM"},null,8,["modelValue"])):S("",!0),N($,{icon:re(ve),size:"small",loading:R.value,circle:"",onClick:m},null,8,["icon","loading"])]}),_:1})],512),[[pe,(D=e.widgetObj.widgetParams[1])==null?void 0:D.value]]),N(E,{data:e.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData,stripe:(V=e.widgetObj.widgetParams[2])==null?void 0:V.value,border:(F=e.widgetObj.widgetParams[3])==null?void 0:F.value,size:(H=e.widgetObj.widgetParams[4])==null?void 0:H.value,"span-method":K,"show-summary":(G=e.widgetObj.widgetParams[8])==null?void 0:G.value,style:se({"--el-table-border-color":(Q=e.widgetObj.widgetParams[9])==null?void 0:Q.value}),"header-cell-style":{background:(X=e.widgetObj.widgetParams[10])==null?void 0:X.value,color:(Z=e.widgetObj.widgetParams[11])==null?void 0:Z.value},"cell-style":{color:(ee=e.widgetObj.widgetParams[12])==null?void 0:ee.value}},{default:i(()=>[(l(!0),p(O,null,x(T(e.widgetObj.widgetParams[0].typeOptions.dataJson.headerData),(y,L)=>(l(),s(Pe,{key:L,column:y,"widget-obj":e.widgetObj},null,8,["column","widget-obj"]))),128))]),_:1},8,["data","stripe","border","size","show-summary","style","header-cell-style","cell-style"]),z("div",_e,[e.widgetObj.widgetParams[7]&&((te=e.widgetObj.widgetParams[7])==null?void 0:te.value)!=-1?(l(),s(_,{key:0,layout:"prev, pager, next",background:"",size:"small","hide-on-single-page":!1,total:e.widgetObj.widgetParams[0].typeOptions.dataJson.total,"current-page":v.value,"onUpdate:currentPage":a[1]||(a[1]=y=>v.value=y),"page-size":U.value,"onUpdate:pageSize":a[2]||(a[2]=y=>U.value=y),onSizeChange:W,onCurrentChange:B},null,8,["total","current-page","page-size"])):S("",!0)])],64)}}},xe=ne(Ve,[["__scopeId","data-v-2702e969"]]);export{xe as default};
