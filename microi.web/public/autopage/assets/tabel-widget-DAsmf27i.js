const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PieChart-BjrBh3RT.js","./index-WFV7e-oS.js","./index-Cv6p236G.css"])))=>i.map(i=>d[i]);
import{_ as ne,r as w,l as oe,c as r,d as l,p as s,L as de,h as y,f as N,K as ue,i as te,y as q,e as b,F as f,z as x,x as re,q as se,A as S,B as ce,C as me,a as ge,w as we,t as be,v as pe,g as I,M as le,N as he}from"./index-WFV7e-oS.js";import{u as ye,g as ve}from"./useWidget-TrsLfogO.js";const fe={key:2,style:{display:"flex","justify-content":"center","align-items":"center"}},Oe={key:4,style:{"margin-left":"5px"}},je={__name:"RecursiveTableColumn",props:{column:{type:Object,required:!0},widgetObj:{type:Object,required:!0}},setup(e){var p,u,P;const J=ce(()=>me(()=>import("./PieChart-BjrBh3RT.js"),__vite__mapDeps([0,1,2]),import.meta.url)),O=e,i=w((p=O.widgetObj.widgetParams[14])==null?void 0:p.value),j=w((u=O.widgetObj.widgetParams[15])==null?void 0:u.value),A=w((P=O.widgetObj.widgetParams[16])==null?void 0:P.value),U=oe(()=>c=>({labels:[c.chart_ui],datasets:[{data:[c.chart_ui,100-c.chart_ui],backgroundColor:[j.value,"#c8c8c820"],borderColor:[A.value,"#c8c8c8"],borderWidth:1}]}));return(c,W)=>{const L=r("el-tag"),M=r("el-space"),V=r("el-progress"),R=r("el-rate"),Y=r("recursive-table-column",!0),B=r("el-table-column");return l(),s(B,{prop:e.column.prop,label:e.column.label,width:e.column.width,align:e.column.align},de({default:y(()=>[e.column.children?(l(!0),b(f,{key:0},x(e.column.children,(n,t)=>(l(),s(Y,{key:t,column:n,"widget-obj":e.widgetObj},null,8,["column","widget-obj"]))),128)):S("",!0)]),_:2},[e.column.children?void 0:{name:"header",fn:y(n=>[N("div",null,[(l(),s(ue(e.column.icon),{class:"icons"})),te(" "+q(n.column.label),1)])]),key:"0"},e.column.children?void 0:{name:"default",fn:y(n=>{var t;return[N("div",null,[e.column.status_ui&&n.row.status_ui?(l(),s(M,{key:0},{default:y(()=>[(l(!0),b(f,null,x(n.row[e.column.prop].split(","),(a,d)=>(l(),s(L,{key:d,type:n.row.status_ui},{default:y(()=>[te(q(a),1)]),_:2},1032,["type"]))),128))]),_:2},1024)):e.column.progress_ui&&n.row.progress_ui?(l(),s(V,{key:1,"text-inside":!0,"stroke-width":(t=e.widgetObj.widgetParams[5])==null?void 0:t.value,status:n.row.progress_ui,percentage:n.row[e.column.prop]},null,8,["stroke-width","status","percentage"])):e.column.chart_ui&&n.row.chart_ui?(l(),b("div",fe,[e.column.chart_ui&&n.row.chart_ui?(l(),s(re(J),{key:0,"chart-data":U.value(n.row),style:se({width:i.value+"px"})},null,8,["chart-data","style"])):S("",!0)])):e.column.rate_ui?(l(),s(R,{key:3,"allow-half":"",disabled:"","show-score":"",modelValue:n.row[e.column.prop],"onUpdate:modelValue":a=>n.row[e.column.prop]=a},null,8,["modelValue","onUpdate:modelValue"])):(l(),b("span",Oe,q(n.row[e.column.prop]),1))])]}),key:"1"}]),1032,["prop","label","width","align"])}}},Pe=ne(je,[["__scopeId","data-v-03576640"]]),ke={class:"date-range"},_e={style:{"margin-top":"12px",display:"flex","justify-content":"flex-end"}},Ce={__name:"tabel-widget",props:{widgetObj:{type:Object,required:!0}},async setup(e){let J,O;const i=e,j=w(!1);w([]);const A=async(t,a,d)=>{if(t&&a.remote&&a.optionUrl){j.value=!0;let D={};try{const o=await ve(a.optionUrl+t,D);o&&o.length>0&&(i.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[d].options=o),j.value=!1}catch(o){console.error("Error fetching data:",o)}finally{j.value=!1}}},U=oe(()=>{var a;let t=10;return i.widgetObj.widgetParams[7]&&(t=(a=i.widgetObj.widgetParams[7])==null?void 0:a.value),t}),p=w(1),u=w({});ge(()=>{var t;(t=i.widgetObj.widgetParams[0].typeOptions.dataJson.searchData)==null||t.forEach((a,d)=>{u.value[d]=a.value})});const P=async()=>{const t={...u.value};for(const[a,d]of Object.entries(t))i.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[a]&&(i.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[a].value=d);await Y()},c=async t=>{p.value=1,await P()},W=async t=>{p.value=1,await P()},L=async t=>{await P()},M=[];M.value=i.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData;const V=w(),R=w(!1),{loadRemoteData:Y}=ye(i.widgetObj,M.value,V,R,p);[J,O]=we(()=>Y()),await J,O();const B=t=>t.map(a=>a.children?{...a,children:B(a.children)}:a),n=({row:t,column:a,rowIndex:d,columnIndex:D})=>{var E;let o=(E=i.widgetObj.widgetParams[6])==null?void 0:E.value;if(!o)return{rowspan:1,colspan:1};let k=i.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData,T=i.widgetObj.widgetParams[0].typeOptions.dataJson.headerData.findIndex(_=>_.prop==o);if(D===T){const _=k[d-1];if(k[d+1],_&&_[o]===t[o])return{rowspan:0,colspan:0};let z=1;for(let C=d+1;C<k.length&&k[C][o]===t[o];C++)z++;return{rowspan:z,colspan:1}}};return(t,a)=>{var z,C,F,G,H,Q,X,Z,ee,ae;const d=r("el-input"),D=r("el-option"),o=r("el-select"),k=r("el-date-picker"),$=r("el-button"),T=r("el-space"),E=r("el-table"),_=r("el-pagination");return l(),b(f,null,[be(N("div",ke,[I(T,{wrap:""},{default:y(()=>{var h,K;return[(l(!0),b(f,null,x((h=e.widgetObj.widgetParams[0].typeOptions.dataJson)==null?void 0:h.searchData,(m,v)=>(l(),b(f,null,[m.type=="input"?(l(),s(d,{key:v,modelValue:u.value[v],"onUpdate:modelValue":g=>u.value[v]=g,size:"small",placeholder:"请输入"+m.label,clearable:"",onKeyup:le(c,["enter"])},null,8,["modelValue","onUpdate:modelValue","placeholder"])):m.type=="select"?(l(),s(o,{class:"pagesearch",style:{"min-width":"120px"},key:v+"select",modelValue:u.value[v],"onUpdate:modelValue":g=>u.value[v]=g,onChange:c,size:"small",placeholder:"请选择"+m.label,clearable:"",filterable:"",remote:m.remote,"remote-method":g=>A(g,m,v),loading:j.value,onKeyup:le(c,["enter"])},{default:y(()=>[(l(!0),b(f,null,x(m.options,(g,ie)=>(l(),s(D,{value:g.value,label:g.label,key:ie+g.value},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","remote","remote-method","loading"])):S("",!0)],64))),256)),(K=e.widgetObj.widgetParams[13])!=null&&K.value?(l(),s(k,{key:0,modelValue:V.value,"onUpdate:modelValue":a[0]||(a[0]=m=>V.value=m),size:"small","unlink-panels":"",type:"monthrange","range-separator":"至","start-placeholder":"起始年月","end-placeholder":"结束年月",format:"YYYY-MM","value-format":"YYYY-MM"},null,8,["modelValue"])):S("",!0),I($,{icon:re(he),size:"small",loading:R.value,circle:"",onClick:c},null,8,["icon","loading"])]}),_:1})],512),[[pe,(z=e.widgetObj.widgetParams[1])==null?void 0:z.value]]),I(E,{data:e.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData,stripe:(C=e.widgetObj.widgetParams[2])==null?void 0:C.value,border:(F=e.widgetObj.widgetParams[3])==null?void 0:F.value,size:(G=e.widgetObj.widgetParams[4])==null?void 0:G.value,"span-method":n,"show-summary":(H=e.widgetObj.widgetParams[8])==null?void 0:H.value,style:se({"--el-table-border-color":(Q=e.widgetObj.widgetParams[9])==null?void 0:Q.value}),"header-cell-style":{background:(X=e.widgetObj.widgetParams[10])==null?void 0:X.value,color:(Z=e.widgetObj.widgetParams[11])==null?void 0:Z.value},"cell-style":{color:(ee=e.widgetObj.widgetParams[12])==null?void 0:ee.value}},{default:y(()=>[(l(!0),b(f,null,x(B(e.widgetObj.widgetParams[0].typeOptions.dataJson.headerData),(h,K)=>(l(),s(Pe,{key:K,column:h,"widget-obj":e.widgetObj},null,8,["column","widget-obj"]))),128))]),_:1},8,["data","stripe","border","size","show-summary","style","header-cell-style","cell-style"]),N("div",_e,[e.widgetObj.widgetParams[7]&&((ae=e.widgetObj.widgetParams[7])==null?void 0:ae.value)!=-1?(l(),s(_,{key:0,layout:"prev, pager, next",background:"",size:"small","hide-on-single-page":!1,total:e.widgetObj.widgetParams[0].typeOptions.dataJson.total,"current-page":p.value,"onUpdate:currentPage":a[1]||(a[1]=h=>p.value=h),"page-size":U.value,"onUpdate:pageSize":a[2]||(a[2]=h=>U.value=h),onSizeChange:W,onCurrentChange:L},null,8,["total","current-page","page-size"])):S("",!0)])],64)}}},ze=ne(Ce,[["__scopeId","data-v-2702e969"]]);export{ze as default};
