import{_ as $,r as b,o as ee,y as ae,c as y,b as i,d as n,e as f,f as te,v as le,g as V,h as v,j as c,F as O,k as S,l as p,m as E,p as K,q as oe,t as se,x as _,P as ne,A as re,O as N}from"./index-BVh9aAA9.js";import{u as de,g as ie}from"./useWidget-DHPg7DNb.js";const ue={class:"date-range"},ce={__name:"statistic-widget",props:{widgetObj:{type:Object,required:!0}},async setup(u){let C,D;const a=u,h=b(!1);b([]);const R=async(e,t,l)=>{if(e&&t.optionUrl){h.value=!0;let g={};try{const m=await ie(t.optionUrl+e,g);m&&m.length>0&&(a.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[l].options=m),h.value=!1}catch(m){console.error("Error fetching data:",m)}finally{h.value=!1}}},w=b({});ee(()=>{var e;(e=a.widgetObj.widgetParams[0].typeOptions.dataJson.searchData)==null||e.forEach((t,l)=>{w.value[l]=t.value})});const j=async e=>{const t={...w.value};for(const[l,g]of Object.entries(t))a.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[l]&&(a.widgetObj.widgetParams[0].typeOptions.dataJson.searchData[l].value=g);await z()},k=b(),J=b(!1),{loadRemoteData:z}=de(a.widgetObj,a.widgetObj.widgetParams[0].typeOptions.dataJson,k,J);[C,D]=ae(()=>z()),await C,D();const A=y(()=>{var e,t;return{backgroundColor:(e=a.widgetObj.widgetParams[2])==null?void 0:e.value,padding:(t=a.widgetObj.widgetParams[3])==null?void 0:t.value}}),F=y(()=>{var e,t,l,g;return{fontSize:(e=a.widgetObj.widgetParams[7])==null?void 0:e.value,fontWeight:(t=a.widgetObj.widgetParams[8])==null?void 0:t.value,color:(l=a.widgetObj.widgetParams[9])==null?void 0:l.value,margin:(g=a.widgetObj.widgetParams[10])==null?void 0:g.value}}),L=y(()=>{var e,t,l;return{fontSize:(e=a.widgetObj.widgetParams[11])==null?void 0:e.value,fontWeight:(t=a.widgetObj.widgetParams[12])==null?void 0:t.value,color:(l=a.widgetObj.widgetParams[13])==null?void 0:l.value}}),Y=y(()=>{var e,t;return{color:(e=a.widgetObj.widgetParams[15])==null?void 0:e.value,fontSize:(t=a.widgetObj.widgetParams[16])==null?void 0:t.value}}),q=y(()=>{var e;return(e=a.widgetObj.widgetParams[0].typeOptions.dataJson)!=null&&e.data?a.widgetObj.widgetParams[0].typeOptions.dataJson.data:a.widgetObj.widgetParams[0].typeOptions.dataJson});return(e,t)=>{var M;const l=i("el-input"),g=i("el-option"),m=i("el-select"),G=i("el-date-picker"),H=i("el-button"),Q=i("el-space"),U=i("el-icon"),T=i("el-statistic"),X=i("el-col"),Z=i("el-row");return n(),f(O,null,[te(V("div",ue,[v(Q,{wrap:""},{default:c(()=>{var r;return[(n(!0),f(O,null,S(a.widgetObj.widgetParams[0].typeOptions.dataJson.searchData,(o,d)=>(n(),f(O,null,[o.type=="input"?(n(),p(l,{key:d,modelValue:w.value[d],"onUpdate:modelValue":s=>w.value[d]=s,size:"small",placeholder:"请输入"+o.label,clearable:"",onKeyup:E(j,["enter"])},null,8,["modelValue","onUpdate:modelValue","placeholder"])):o.type=="select"?(n(),p(m,{class:"pagesearch",style:{"min-width":"120px"},key:d+"select",modelValue:w.value[d],"onUpdate:modelValue":s=>w.value[d]=s,onChange:j,size:"small",placeholder:"请选择"+o.label,clearable:"",filterable:"",remote:"","remote-method":s=>R(s,o,d),loading:h.value,onKeyup:E(j,["enter"])},{default:c(()=>[(n(!0),f(O,null,S(o.options,(s,P)=>(n(),p(g,{value:s.value,label:s.label,key:P+s.value},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","remote-method","loading"])):K("",!0)],64))),256)),(r=u.widgetObj.widgetParams[19])!=null&&r.value?(n(),p(G,{key:0,modelValue:k.value,"onUpdate:modelValue":t[0]||(t[0]=o=>k.value=o),size:"small","unlink-panels":"",type:"monthrange","range-separator":"至","start-placeholder":"起始年月","end-placeholder":"结束年月",format:"YYYY-MM","value-format":"YYYY-MM"},null,8,["modelValue"])):K("",!0),v(H,{icon:oe(se),size:"small",loading:J.value,circle:"",onClick:j},null,8,["icon","loading"])]}),_:1})],512),[[le,(M=u.widgetObj.widgetParams[18])==null?void 0:M.value]]),v(Z,{style:{width:"100%"}},{default:c(()=>[(n(!0),f(O,null,S(q.value,(r,o)=>{var d;return n(),p(X,{key:o,class:"el-col",span:(d=u.widgetObj.widgetParams[1])==null?void 0:d.value,style:_(A.value)},{default:c(()=>{var s,P,B,I,W,x;return[v(T,{style:_([{backgroundColor:r.bgColor?r.bgColor:(P=(s=u.widgetObj.widgetParams[4])==null?void 0:s.value)==null?void 0:P.split(",")[o>7?0:o]},{padding:(B=u.widgetObj.widgetParams[5])==null?void 0:B.value},{borderRadius:(I=u.widgetObj.widgetParams[6])==null?void 0:I.value},{backgroundImage:r.bgImage?r.bgImage:"url("+((W=u.widgetObj.widgetParams[17])==null?void 0:W.value)+")"}]),"value-style":L.value,value:r.value},ne({title:c(()=>[V("div",{style:_(F.value)},[V("span",null,re(r.name),1)],4)]),_:2},[((x=u.widgetObj.widgetParams[14])==null?void 0:x.value)=="prefix"?{name:"prefix",fn:c(()=>[v(U,{style:_(Y.value)},{default:c(()=>[(n(),p(N(r.icon)))]),_:2},1032,["style"])]),key:"0"}:{name:"suffix",fn:c(()=>[v(U,{style:_(Y.value)},{default:c(()=>[(n(),p(N(r.icon)))]),_:2},1032,["style"])]),key:"1"}]),1032,["style","value-style","value"])]}),_:2},1032,["span","style"])}),128))]),_:1})],64)}}},pe=$(ce,[["__scopeId","data-v-491b5f95"]]);export{pe as default};
