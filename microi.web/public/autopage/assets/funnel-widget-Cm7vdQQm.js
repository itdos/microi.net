import{i as I}from"./index-C2kp-yMC.js";import{_ as R,u as L,s as W,r as P,j as S,a as F,k as J,n as k,b as H,d as z,e as T,l as V,f as q,m as A,F as M}from"./index-Dn06OfP0.js";import{C as N}from"./CommonSearch-CZMmwwvS.js";import"./useWidget-BGRWNsmQ.js";import"./axiosInstance-C6G-1kSY.js";const U={__name:"funnel-widget",props:{widgetObj:{type:Object,required:!0}},setup(r){var w,c;const _=L(),{curWrapper:E,dark:l}=W(_),e=r,s=P(null);let i=null;const B=S(()=>{var o;let a=(o=e.widgetObj.widgetParams[1])!=null&&o.value?40:0;return e.widgetObj.widgetOption.height-a+"px"}),t=P({});t.value={title:{show:!0,text:"",subtext:"",textStyle:{color:l.value?"#999":"#333",fontStyle:"normal",fontWeight:"bolder",fontFamily:"sans-serif",fontSize:18}},tooltip:{trigger:"item",show:!0,axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{show:!0,type:"scroll",textStyle:{color:l.value?"#999":"#333"},orient:(w=e.widgetObj.widgetParams[6])==null?void 0:w.value,left:(c=e.widgetObj.widgetParams[7])==null?void 0:c.value,data:[]},grid:{show:!1,left:"10%",right:"4%",bottom:"30px",containLabel:!1},toolbox:{show:!0,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},series:[]},F(()=>{window.addEventListener("resize",n)}),J(()=>{window.removeEventListener("resize",n)});const d=()=>{console.log("重置数据"),k(()=>{i&&i.dispose(),s.value&&(i=I(s.value),u())})},C=()=>{i.setOption(t.value)},u=()=>{var a,o,m,v,b,p,f,h,O,j,x,y;t.value.legend.orient=(a=e.widgetObj.widgetParams[6])==null?void 0:a.value,t.value.legend.left=(o=e.widgetObj.widgetParams[7])==null?void 0:o.value,t.value.title.textStyle.color=l.value?"#999":"#333",t.value.legend.textStyle.color=l.value?"#999":"#333",t.value.title.text=(m=e.widgetObj.widgetParams[3])==null?void 0:m.value,t.value.title.subtext=(v=e.widgetObj.widgetParams[4])==null?void 0:v.value,t.value.legend.show=(b=e.widgetObj.widgetParams[5])==null?void 0:b.value,t.value.tooltip.show=(p=e.widgetObj.widgetParams[8])==null?void 0:p.value,t.value.tooltip.trigger=(f=e.widgetObj.widgetParams[9])==null?void 0:f.value,t.value.toolbox.show=(h=e.widgetObj.widgetParams[10])==null?void 0:h.value,t.value.series=[{type:"funnel",left:"10%",top:40,bottom:10,width:"80%",min:0,max:100,minSize:"0%",maxSize:"100%",sort:(O=e.widgetObj.widgetParams[14])==null?void 0:O.value,gap:2,label:{show:(j=e.widgetObj.widgetParams[11])==null?void 0:j.value,position:(x=e.widgetObj.widgetParams[12])==null?void 0:x.value},labelLine:{length:10,lineStyle:{width:1,type:"solid"}},itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{label:{fontSize:20}},data:g.value}],t.value.legend.data=[],(y=g.value)==null||y.forEach((D,G)=>{t.value.legend.data.push(D.name)}),C()},n=()=>{k(()=>{i&&s.value&&i.resize()})};H([()=>e.widgetObj,()=>E.value,()=>l.value],()=>{d(),n()},{deep:!0});const g=S(()=>{var a;return(a=e.widgetObj.widgetParams[0].typeOptions.dataJson)!=null&&a.data?e.widgetObj.widgetParams[0].typeOptions.dataJson.data:e.widgetObj.widgetParams[0].typeOptions.dataJson});return(a,o)=>(z(),T(M,null,[(z(),V(N,{widgetObj:r.widgetObj,searchIndex:1,pickerIndex:13,key:r.widgetObj.widgetOption.number,onSetData:u,onResetData:d},null,8,["widgetObj"])),q("div",{ref_key:"chartRef",ref:s,style:A([{width:"100%"},{height:B.value}])},null,4)],64))}},$=R(U,[["__scopeId","data-v-0c55adc8"]]);export{$ as default};
