import{_ as G,b as s,d as n,l as u,N as Z,j as p,g as x,M as ee,z as W,A as R,e as g,F as f,k as D,p as B,r as y,c as ae,y as te,f as le,v as ne,h as z,m as $,q as oe,t as re}from"./index-CzHq7BTH.js";import{u as se,g as ue}from"./useWidget-Dgw0rFUF.js";const de={key:3,style:{"margin-left":"5px"}},ie={__name:"RecursiveTableColumn",props:{column:{type:Object,required:!0},widgetObj:{type:Object,required:!0}},setup(e){return(U,S)=>{const d=s("el-tag"),P=s("el-progress"),w=s("el-rate"),Y=s("recursive-table-column",!0),_=s("el-table-column");return n(),u(_,{prop:e.column.prop,label:e.column.label,width:e.column.width,align:e.column.align},Z({default:p(()=>[e.column.children?(n(!0),g(f,{key:0},D(e.column.children,(a,c)=>(n(),u(Y,{key:c,column:a,"widget-obj":e.widgetObj},null,8,["column","widget-obj"]))),128)):B("",!0)]),_:2},[e.column.children?void 0:{name:"header",fn:p(a=>[x("div",null,[(n(),u(ee(e.column.icon),{class:"icons"})),W(" "+R(a.column.label),1)])]),key:"0"},e.column.children?void 0:{name:"default",fn:p(a=>{var c;return[x("div",null,[e.column.status_ui&&a.row.status_ui?(n(),u(d,{key:0,type:a.row.status_ui},{default:p(()=>[W(R(a.row[e.column.prop]),1)]),_:2},1032,["type"])):e.column.progress_ui&&a.row.progress_ui?(n(),u(P,{key:1,"text-inside":!0,"stroke-width":(c=e.widgetObj.widgetParams[5])==null?void 0:c.value,status:a.row.progress_ui,percentage:a.row[e.column.prop]},null,8,["stroke-width","status","percentage"])):e.column.rate_ui?(n(),u(w,{key:2,"allow-half":"",disabled:"","show-score":"",modelValue:a.row[e.column.prop],"onUpdate:modelValue":J=>a.row[e.column.prop]=J},null,8,["modelValue","onUpdate:modelValue"])):(n(),g("span",de,R(a.row[e.column.prop]),1))])]}),key:"1"}]),1032,["prop","label","width","align"])}}},ce=G(ie,[["__scopeId","data-v-ea4e1344"]]),me={class:"date-range"},ge={style:{"margin-top":"12px",display:"flex","justify-content":"flex-end"}},pe={__name:"tabel-widget",props:{widgetObj:{type:Object,required:!0}},async setup(e){let U,S;const d=e,P=y(d.widgetObj.widgetParams[0].typeOptions.dataJson.searchData),w=y(!1);y([]);const Y=async(o,t,m)=>{if(o&&t.optionUrl){w.value=!0;let j={};try{const r=await ue(t.optionUrl+o,j);r&&r.length>0&&(P.value[m].options=r),w.value=!1}catch(r){console.error("Error fetching data:",r)}finally{w.value=!1}}},_=ae(()=>{var t;let o=10;return d.widgetObj.widgetParams[7]&&(o=(t=d.widgetObj.widgetParams[7])==null?void 0:t.value),o}),a=y(1),c=async o=>{a.value=1,await V()},J=async o=>{a.value=1,await V()},H=async o=>{await V()},K=[];K.value=d.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData;const M=y(),q=y(!1),{loadRemoteData:V}=se(d.widgetObj,K.value,M,q,a);[U,S]=te(()=>V()),await U,S();const T=o=>o.map(t=>t.children?{...t,children:T(t.children)}:t),Q=({row:o,column:t,rowIndex:m,columnIndex:j})=>{var C;let r=(C=d.widgetObj.widgetParams[6])==null?void 0:C.value;if(!r)return{rowspan:1,colspan:1};let b=d.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData,N=d.widgetObj.widgetParams[0].typeOptions.dataJson.headerData.findIndex(h=>h.prop==r);if(j===N){const h=b[m-1];if(b[m+1],h&&h[r]===o[r])return{rowspan:0,colspan:0};let O=1;for(let v=m+1;v<b.length&&b[v][r]===o[r];v++)O++;return{rowspan:O,colspan:1}}};return(o,t)=>{var O,v,E,F,I,L;const m=s("el-input"),j=s("el-option"),r=s("el-select"),b=s("el-date-picker"),A=s("el-button"),N=s("el-space"),C=s("el-table"),h=s("el-pagination");return n(),g(f,null,[le(x("div",me,[z(N,{wrap:""},{default:p(()=>[(n(!0),g(f,null,D(P.value,(l,k)=>(n(),g(f,null,[l.type=="input"?(n(),u(m,{key:k,modelValue:l.value,"onUpdate:modelValue":i=>l.value=i,size:"small",placeholder:"请输入"+l.label,clearable:"",onKeyup:$(c,["enter"])},null,8,["modelValue","onUpdate:modelValue","placeholder"])):l.type=="select"?(n(),u(r,{class:"pagesearch",style:{"min-width":"120px"},key:k+"select",modelValue:l.value,"onUpdate:modelValue":i=>l.value=i,size:"small",placeholder:"请选择"+l.label,clearable:"",filterable:"",remote:"","remote-method":i=>Y(i,l,k),loading:w.value,onKeyup:$(c,["enter"])},{default:p(()=>[(n(!0),g(f,null,D(l.options,(i,X)=>(n(),u(j,{value:i.value,label:i.label,key:X+i.value},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","remote-method","loading"])):B("",!0)],64))),256)),z(b,{modelValue:M.value,"onUpdate:modelValue":t[0]||(t[0]=l=>M.value=l),size:"small","unlink-panels":"",type:"monthrange","range-separator":"至","start-placeholder":"起始年月","end-placeholder":"结束年月",format:"YYYY-MM","value-format":"YYYY-MM"},null,8,["modelValue"]),z(A,{icon:oe(re),size:"small",loading:q.value,circle:"",onClick:c},null,8,["icon","loading"])]),_:1})],512),[[ne,(O=e.widgetObj.widgetParams[1])==null?void 0:O.value]]),z(C,{data:e.widgetObj.widgetParams[0].typeOptions.dataJson.bodyData,stripe:(v=e.widgetObj.widgetParams[2])==null?void 0:v.value,border:(E=e.widgetObj.widgetParams[3])==null?void 0:E.value,size:(F=e.widgetObj.widgetParams[4])==null?void 0:F.value,"span-method":Q,"show-summary":(I=e.widgetObj.widgetParams[8])==null?void 0:I.value},{default:p(()=>[(n(!0),g(f,null,D(T(e.widgetObj.widgetParams[0].typeOptions.dataJson.headerData),(l,k)=>(n(),u(ce,{key:k,column:l,"widget-obj":e.widgetObj},null,8,["column","widget-obj"]))),128))]),_:1},8,["data","stripe","border","size","show-summary"]),x("div",ge,[e.widgetObj.widgetParams[7]&&((L=e.widgetObj.widgetParams[7])==null?void 0:L.value)!=-1?(n(),u(h,{key:0,layout:"prev, pager, next",background:"",size:"small","hide-on-single-page":!1,total:e.widgetObj.widgetParams[0].typeOptions.dataJson.total,"current-page":a.value,"onUpdate:currentPage":t[1]||(t[1]=l=>a.value=l),"page-size":_.value,"onUpdate:pageSize":t[2]||(t[2]=l=>_.value=l),onSizeChange:J,onCurrentChange:H},null,8,["total","current-page","page-size"])):B("",!0)])],64)}}},he=G(pe,[["__scopeId","data-v-f06ad440"]]);export{he as default};
