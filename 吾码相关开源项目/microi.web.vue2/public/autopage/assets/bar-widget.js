import{i as F}from"./index2.js";import{_ as G,u as H,s as J,r as k,j as W,a as q,k as M,n as L,b as N,d as _,e as U,l as V,f as K,m as Q,F as X}from"./index.js";import{C as Y}from"./CommonSearch.js";import"./useWidget.js";import"./axiosInstance.js";const Z={__name:"bar-widget",props:{widgetObj:{type:Object,required:!0}},setup(d){const E=H(),{curWrapper:I,dark:s}=J(E),t=d,r=k(null);let l=null;const R=W(()=>{var a;let i=(a=t.widgetObj.widgetParams[1])!=null&&a.value?40:0;return t.widgetObj.widgetOption.height-i+"px"}),e=k({title:{text:"",subtext:"",textStyle:{color:"#333"}},tooltip:{trigger:"axis",show:!0,axisPointer:{type:"cross"}},legend:{orient:"vertical",left:"left",show:!0,textStyle:{color:"#333"}},xAxis:{type:"category",data:[],axisLabel:{color:"#333"},boundaryGap:!0},yAxis:{type:"value",axisLabel:{color:"#333"},splitLine:{show:!0}},series:[],toolbox:{show:!1}}),z=(i,a)=>{let o;return function(...u){clearTimeout(o),o=setTimeout(()=>i.apply(this,u),a)}};q(()=>{window.addEventListener("resize",n)}),M(()=>{window.removeEventListener("resize",n)});const c=()=>{console.log("重置数据"),L(()=>{l&&l.dispose(),r.value&&(l=F(r.value),w())})},B=()=>{l.setOption(e.value)},w=()=>{var i,a,o,u,v,m,p,b,x,O,h,j,y,f;e.value.xAxis.type=(i=t.widgetObj.widgetParams[17])!=null&&i.value?"value":"category",e.value.yAxis.type=(a=t.widgetObj.widgetParams[17])!=null&&a.value?"category":"value",e.value.title.textStyle.color=s.value?"#999":"#333",e.value.legend.textStyle.color=s.value?"#999":"#333",e.value.xAxis.axisLabel.color=s.value?"#999":"#333",e.value.yAxis.axisLabel.color=s.value?"#999":"#333",e.value.tooltip.axisPointer.type=(o=t.widgetObj.widgetParams[3])==null?void 0:o.value,e.value.legend.orient=(u=t.widgetObj.widgetParams[8])==null?void 0:u.value,e.value.legend.left=(v=t.widgetObj.widgetParams[9])==null?void 0:v.value,e.value.title.text=(m=t.widgetObj.widgetParams[5])==null?void 0:m.value,e.value.title.subtext=(p=t.widgetObj.widgetParams[6])==null?void 0:p.value,e.value.legend.show=(b=t.widgetObj.widgetParams[7])==null?void 0:b.value,e.value.tooltip.show=(x=t.widgetObj.widgetParams[10])==null?void 0:x.value,e.value.tooltip.trigger=(O=t.widgetObj.widgetParams[11])==null?void 0:O.value,e.value.toolbox.show=(h=t.widgetObj.widgetParams[12])==null?void 0:h.value,e.value.xAxis.data=t.widgetObj.widgetParams[0].typeOptions.dataJson.xAxis,e.value.xAxis.boundaryGap=(j=t.widgetObj.widgetParams[2])==null?void 0:j.value,e.value.yAxis.splitLine.show=(y=t.widgetObj.widgetParams[15])==null?void 0:y.value,e.value.series=[],e.value.legend.data=[],(f=t.widgetObj.widgetParams[0].typeOptions.dataJson.series)==null||f.forEach((g,$)=>{var P,S;const T={type:"bar",name:g.name,data:g.data,tooltip:{valueFormatter:function(C){var A;return C+" "+((A=t.widgetObj.widgetParams[4])==null?void 0:A.value)}},label:{show:(P=t.widgetObj.widgetParams[13])==null?void 0:P.value,position:(S=t.widgetObj.widgetParams[14])==null?void 0:S.value}};e.value.series.push(T),e.value.legend.data.push(g.name)}),B()},n=()=>{L(()=>{r.value&&l.resize()})},D=z(()=>{c(),n()},1e3);return N([()=>t.widgetObj,()=>I.value,()=>s.value],()=>{D()},{deep:!0}),(i,a)=>(_(),U(X,null,[(_(),V(Y,{widgetObj:d.widgetObj,searchIndex:1,pickerIndex:16,key:d.widgetObj.widgetOption.number,onSetData:w,onResetData:c},null,8,["widgetObj"])),K("div",{ref_key:"chartRef",ref:r,style:Q([{width:"100%"},{height:R.value}])},null,4)],64))}},le=G(Z,[["__scopeId","data-v-d2c479ba"]]);export{le as default};
