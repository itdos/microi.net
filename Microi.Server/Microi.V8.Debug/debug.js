/**
 * API å¼•æ“æ–­ç‚¹è°ƒè¯•å…¥å£æ–‡ä»¶
 * 
 * ğŸ¯ ä½¿ç”¨æ–¹æ³•ï¼š
 * 1. ä¿®æ”¹ä¸‹æ–¹çš„ targetFile ä¸ºè¦è°ƒè¯•çš„æ–‡ä»¶
 * 2. ä¿®æ”¹ params ä¸ºæµ‹è¯•å‚æ•°
 * 3. åœ¨ç›®æ ‡ .js æ–‡ä»¶ä¸­è®¾ç½®æ–­ç‚¹
 * 4. æŒ‰ F5 å¯åŠ¨è°ƒè¯•ï¼ˆé€‰æ‹© "è°ƒè¯•å½“å‰ API å¼•æ“"ï¼‰
 * 
 * ğŸ’¡ æç¤ºï¼šæ–­ç‚¹åº”è¯¥è®¾ç½®åœ¨ api-engines ç›®å½•ä¸‹çš„ç›®æ ‡æ–‡ä»¶ä¸­
 */

const { runApiEngine, V8 } = require('./debug-runner');
const path = require('path');

// ============================================
// âš™ï¸ é…ç½®åŒºåŸŸ - ä¿®æ”¹è¿™é‡Œ
// ============================================

// è¦è°ƒè¯•çš„ API å¼•æ“æ–‡ä»¶ï¼ˆç›¸å¯¹äº api-engines ç›®å½•ï¼‰
// æ–°è·¯å¾„ç»“æ„ï¼š{OsClient}/{OsClientType}/{OsClientNetwork}/{Category}/{ApiEngineKey}.js
const targetFile = 'iTdos/Product/Internal/æœªåˆ†ç±»/dns_sync_ip.js';

// è¯·æ±‚å‚æ•°ï¼ˆæ¨¡æ‹Ÿå‰ç«¯ä¼ å…¥çš„å‚æ•°ï¼‰
const params = {
    Key: 'iTdos',  // æ­¤æ¥å£éœ€è¦çš„éªŒè¯å‚æ•°
    // JobParam: JSON.stringify({ Key: 'iTdos' })  // å¦‚æœä»å®šæ—¶ä»»åŠ¡è°ƒç”¨
};

// ============================================
// ğŸ”§ å¯é€‰ï¼šä¿®æ”¹æ¨¡æ‹Ÿé…ç½®
// ============================================

// å¦‚æœéœ€è¦ï¼Œå¯ä»¥åœ¨è¿™é‡Œä¿®æ”¹ V8 çš„æ¨¡æ‹Ÿæ•°æ®
// V8.OsClient = 'your-client';
// V8.OsClientModel.AlidnsKeyId = 'real-key-id';

// ============================================
// ğŸš€ æ‰§è¡Œè°ƒè¯•
// ============================================

async function debug() {
    const filePath = path.join(__dirname, 'api-engines', targetFile);
    
    console.log('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—');
    console.log('â•‘           V8 æ¥å£å¼•æ“ - æœ¬åœ°æ–­ç‚¹è°ƒè¯•                    â•‘');
    console.log('â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£');
    console.log('â•‘ ğŸ“„ ç›®æ ‡æ–‡ä»¶:', targetFile.padEnd(42) + 'â•‘');
    console.log('â•‘ ğŸ’¡ æç¤º: åœ¨ç›®æ ‡æ–‡ä»¶ä¸­è®¾ç½®æ–­ç‚¹åæŒ‰ F5 è°ƒè¯•              â•‘');
    console.log('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
    console.log('');
    
    // â¬‡ï¸ åœ¨è¿™é‡Œè®¾ç½®æ–­ç‚¹ï¼ŒStep Into å¯è¿›å…¥ runApiEngine
    const result = await runApiEngine(filePath, params);
    
    console.log('');
    console.log('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—');
    console.log('â•‘                    è°ƒè¯•å®Œæˆ                             â•‘');
    console.log('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
    
    return result;
}

// è¿è¡Œ
debug().catch(err => {
    console.error('âŒ è°ƒè¯•å¤±è´¥:', err.message);
    process.exit(1);
});
