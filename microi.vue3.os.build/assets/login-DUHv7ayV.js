import{_ as B,m as A,u as L,e as h,f as M,g as I,M as t,o as x,c as N,b as n,h as s,t as v,a as l,w as i,i as w,j as D,d as b,k as E,l as O,n as R,r as u}from"./index-DxamBtFS.js";const U={class:"uv3__launch"},G={class:"uv3__launch-splash flexbox flex-col"},H={class:"uv3__launch-splashwrap flexbox flex-col flex1"},K={class:"body flex1"},j={class:"imgs flex-c"},F={href:"javascript:;"},W=["src","alt"],q={class:"c-primary fs-36 ff-ab text-gradient"},z={style:{width:"15px"}},J={style:{width:"15px"}},Q={style:{width:"15px"}},X=["innerHTML"],Y={__name:"login",setup(Z){const V=R(),{$t:p}=V.appContext.config.globalProperties,o=A(),T=L(),_=h(o.SysConfig.LoginBottomContent||"microi.net");M(()=>{console.log("Microi： views/auth/login.vue"),y(),_.value=_.value.replace("$OsVersion$",o.OsVersion).replace("$SysShortTitle$",o.SysConfig.SysShortTitle).replace("$SysTitle$",o.SysConfig.SysTitle).replace("$CompanyName$",o.SysConfig.CompanyName),LoadRate(30)});const a=I({Account:"",Pwd:"",_CaptchaId:"",_CaptchaValue:""}),y=async(g,e,m)=>{if(o.SysConfig.EnableCaptcha||e){var c=await t.Get(t.ApiBase+t.Api.GetCaptcha,{OsClient:t.OsClient},null,{ResponseType:"arraybuffer"});t.CheckResult(c)&&($("#CaptchaImg").attr("src","data:image/png;base64,"+t.ArrayBufferToBase64(c.Data)),a._CaptchaId=c.Headers.captchaid)}},d=h(!1),k=h(!0),f=async()=>{if(!a.Account||!a.Pwd){t.Tips("请填写帐号、密码！",!1);return}if(o.SysConfig.EnableCaptcha&&!a._CaptchaValue){t.Tips("请填写验证码！",!1);return}if(!d.value){if(d.value=!0,o.SysConfig.EnablePrivacyPolicy&&!k){t.Tips(`请先勾选[${o.SysConfig.PrivacyPolicyName||"同意隐私协议"}]！`,!1),d.value=!1;return}var g={...a};g.OsClient=t.OsClient,t.Post(t.Api.Login,g,function(e){t.CheckResult(e)?(t.Tips((e.Data.Name||e.Data.Account)+p("Msg.WelcomeBack")),o.SetState("CurrentUser",e.Data),T.push("/")):(y(),a._CaptchaValue=""),d.value=!1},{DataType:"form"})}};return(g,e)=>{const m=u("font-awesome-icon"),c=u("el-input"),C=u("el-form-item"),S=u("el-button"),P=u("el-form");return x(),N("div",U,[n("div",G,[n("div",H,[n("div",K,[n("div",j,[n("a",F,[n("img",{src:s(o).SysConfig.FileServer+s(o).SysConfig.SysLogo,class:"logo",alt:s(o).SysConfig.SysTitle},null,8,W)]),n("h2",q,v(s(o).SysConfig.SysTitle),1)]),l(P,{model:a,"label-width":"auto",style:{margin:"0 auto"}},{default:i(()=>[l(C,{label:""},{default:i(()=>[l(c,{modelValue:a.Account,"onUpdate:modelValue":e[0]||(e[0]=r=>a.Account=r),placeholder:s(p)("Msg.InputAccount")},{prepend:i(()=>[n("div",z,[l(m,{icon:"user"})])]),_:1},8,["modelValue","placeholder"])]),_:1}),l(C,{label:""},{default:i(()=>[l(c,{modelValue:a.Pwd,"onUpdate:modelValue":e[2]||(e[2]=r=>a.Pwd=r),placeholder:s(p)("Msg.InputPwd"),type:"password","show-password":"",onKeyup:e[3]||(e[3]=w(r=>f(),["enter"]))},D({prepend:i(()=>[n("div",J,[l(m,{icon:"lock"})])]),_:2},[s(o).SysConfig.EnableCaptcha?void 0:{name:"append",fn:i(()=>[l(S,{type:"",loading:d.value,onClick:e[1]||(e[1]=r=>f()),icon:"ArrowRightBold",style:{"padding-top":"0px","padding-bottom":"0px"}},{default:i(()=>[b(v(s(p)("Msg.Login")),1)]),_:1},8,["loading"])]),key:"0"}]),1032,["modelValue","placeholder"])]),_:1}),s(o).SysConfig.EnableCaptcha?(x(),E(C,{key:0,label:""},{default:i(()=>[l(c,{modelValue:a._CaptchaValue,"onUpdate:modelValue":e[6]||(e[6]=r=>a._CaptchaValue=r),placeholder:s(p)("Msg.InputCaptcha"),onKeyup:e[7]||(e[7]=w(r=>f(),["enter"]))},{prepend:i(()=>[n("div",Q,[l(m,{icon:"arrow-down-1-9"})])]),append:i(()=>[n("img",{id:"CaptchaImg",src:"",style:{height:"30px",cursor:"pointer","margin-left":"-20px","margin-right":"20px","border-right":"solid 1px #dcdfe6"},onClick:e[4]||(e[4]=r=>y())}),l(S,{type:"",loading:d.value,onClick:e[5]||(e[5]=r=>f()),icon:"ArrowRightBold",style:{"padding-top":"0px","padding-bottom":"0px"}},{default:i(()=>[b(v(s(p)("Msg.Login")),1)]),_:1},8,["loading"])]),_:1},8,["modelValue","placeholder"])]),_:1})):O("",!0)]),_:1},8,["model"])]),n("div",{class:"foot",style:{"text-align":"center"},innerHTML:_.value},null,8,X)])])])}}},oe=B(Y,[["__scopeId","data-v-7340999c"]]);export{oe as default};
