Report EngineIntroductionThe report engine is implemented by a combination of [Data Source Engine Interface Engine Form Engine Module Engine]. Currently, only table presentation is supported, and 'ECharts' graphical presentation is under development.

Feature Highlights1. æ”¯æŒå®Œå…¨è‡ªå®šä¹‰çš„å¢ã€åˆ ã€æ”¹ã€æŸ¥ï¼šä¸€èˆ¬ç»Ÿè®¡æŠ¥è¡¨æ•°æ®æ¥æºäºå¤šå¼ è¡¨ï¼Œåœ¨æ‰§è¡Œæ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤æ—¶å¯èƒ½éœ€è¦æ“ä½œå¤šå¼ è¡¨ï¼Œå¯é€šè¿‡æ¥å£å¼•æ“äº‹åŠ¡å®ç°ã€‚
2. æŠ¥è¡¨å‡ä¼šç”Ÿæˆè™šæ‹Ÿ `diy_table` è¡¨ã€è™šæ‹Ÿ `diy_field` å­—æ®µ
3. æŠ¥è¡¨æ”¯æŒç‹¬ç«‹è¡¨å•è®¾è®¡ï¼ˆè™šæ‹Ÿå­—æ®µï¼‰
4. æ”¯æŒã€æ¨¡å—å¼•æ“ã€‘ä¸ºæŠ¥è¡¨é…ç½®æŸ¥è¯¢åˆ—ã€å¯ç¼–è¾‘åˆ—ã€å¯æœç´¢åˆ—ç­‰ç­‰

Create a tabular report1. åˆ›å»ºä¸€æ¡æ•°æ®æºå¼•æ“ã€‚ç›®å‰ä¸€ä¸ªæŠ¥è¡¨å¼•æ“å‡éœ€è¦ä¸€ä¸ªæ•°æ®æºå¼•æ“æ¥æä¾›æ•°æ®æºæ”¯æ’‘ã€‚æ•°æ®æºæ”¯æŒ `SQLã€V8ã€JSON`ï¼ˆè‹¥è€ç‰ˆæœ¬æ•°æ®æºç±»å‹ä¸­åŒ…å«ä¸­æ–‡ï¼Œè¯·ä¿®æ”¹ä¸ºæ­¤ä¸‰é¡¹å°±å¤§å†™å­—æ¯ï¼‰
2. åˆ›å»ºä¸€æ¡æŠ¥è¡¨å¼•æ“ã€‚é€‰æ‹©ç›¸åº”çš„æ•°æ®æºï¼Œä¿å­˜åå†é…ç½®ä¸€ä¸‹éœ€è¦æ˜¾ç¤ºçš„å­—æ®µ
3. åœ¨ã€æ¨¡å—å¼•æ“DIYã€‘æ–°å¢ä¸€ä¸ªæ¨¡å—ï¼Œé€‰æ‹©æ‰“å¼€æ–¹å¼é€‰æ‹©ã€DIYã€‘ã€‚å¹¶é€‰æ‹©åˆšåˆšè‡ªåŠ¨ç”Ÿæˆçš„è™šæ‹ŸæŠ¥è¡¨
4. åœ¨ã€æŠ¥è¡¨å¼•æ“ã€‘è®¾è®¡ä¸­ï¼Œä¿®æ”¹ã€æŸ¥è¯¢æ¥å£æ›¿æ¢ã€æ–°å¢æ¥å£æ›¿æ¢ã€ä¿®æ”¹æ¥å£æ›¿æ¢ã€åˆ é™¤æ¥å£æ›¿æ¢ã€‘ä¸ºæ¥å£å¼•æ“ç›¸åº”çš„å®ç°æ¥å£ï¼ˆå¦‚æ›¿æ¢ä¸ºï¼š`/apiengine/get_webuser_info` ï¼‰

Implementation effect displayThe customer is a small program of the mall, and points can be obtained by shopping on the small program. This report records the points consumption statistics of the number of points consumption orders generated by each merchant.

You can search and filter by the name of the head merchant and the order time, and dynamically count the points order statistics within a given time.


! [Report Engine](/api_plugins/report01.png)

Implementation stepsAdd Data Source EngineAdd a new data source to the data source engine to count the data in the report. The implementation code is as follows:

```js
// åˆ†é¡µå‚æ•°
var pageIndex = V8.Param._PageIndex || 1;
var pageSize = V8.Param._PageSize || 15;
var PageNum = 0
if (pageIndex > 1) {
  PageNum = pageSize * (pageIndex - 1)
}
 
// æœç´¢æ¡ä»¶
var ShanghuMC = ''
var _Where = V8.Param._Where || '';
if(_Where){
  _Where = JSON.parse(_Where)
  _Where.forEach(item=>{
    if(item.Name == 'ShanghuMC') ShanghuMC = item.Value
  })
}
// å…³é”®è¯æœç´¢
var _Keyword = ''
if(V8.Param._Keyword){
  _Keyword = V8.Param._Keyword
}
// æ—¶é—´æœç´¢æ¡ä»¶
var KaishiSJ = ''
var JieshuSJ = ''
var where1 = ''
if(V8.Param._SearchDateTime){
  var ShijianFW = V8.Param._SearchDateTime.ShijianFW
  if(ShijianFW){
    KaishiSJ = ShijianFW[0]
    JieshuSJ = ShijianFW[1]
    KaishiSJ = `${KaishiSJ} 00:00:00`
    JieshuSJ = `${JieshuSJ} 23:59:59`
    where1 = `and CreateTime >= '${KaishiSJ}' and CreateTime <= '${JieshuSJ}'`
  }
  
}
 
// ç»Ÿè®¡æ€»å…±çš„æ¡æ•°
var Count =  V8.Db.FromSql(`select count(Id) from diy_shanghuGL where IsDeleted = 0 and ShenheZT = 'å·²é€šè¿‡' and ShangjiaZT = 'ä¸Šæ¶' and ShanghuMC Like '%${ShanghuMC}%' and ShanghuMC Like '%${_Keyword}%'`).ToScalar()
 
// è·å–ä¸»æ•°æ®
var ShanghuInfo = V8.Db.FromSql(`select * from diy_shanghuGL where IsDeleted = 0 and ShenheZT = 'å·²é€šè¿‡' and ShangjiaZT = 'ä¸Šæ¶' and ShanghuMC Like '%${ShanghuMC}%' and ShanghuMC Like '%${_Keyword}%'  limit ${PageNum},${pageSize} `).ToArray()
var data = []
 
// å†™ä»£ç é€»è¾‘è·å–éœ€è¦çš„å†…å®¹
ShanghuInfo.forEach(item=>{
  var FuzeR = V8.Db.FromSql(`select * from sys_user where Id = '${item.FuzeRID}'`).ToArray();
  FuzeR = FuzeR[0];
  var obj = {
    ShanghuMC:item.ShanghuMC,
    FuzeRXM : FuzeR.Name || FuzeR.Account,
    FuzeR : FuzeR.Account,
    YonghuID : FuzeR.Id,
    ShanghuSK : 0,
    DingDanShu:0,
    ShanghuID : item.Id,
    ShanghuLOGO : item.ShanghuLOGO
  }
// æ¶ˆè´¹ç§¯åˆ†ç»Ÿè®¡
  obj.ShanghuSK = V8.Db.FromSql(`select sum(XiaofeiJF) from diy_JFXFMX where IsDeleted =0 and (HexiaoZT = 'å·²å®Œæˆ' or HexiaoZT = 'å¾…è¯„ä»·' ) and ShanghuID = '${item.Id}' ` + where1).ToScalar()
  obj.ShanghuSK = obj.ShanghuSK || 0
// è®¢å•æ•°ç»Ÿè®¡
  obj.DingDanShu = V8.Db.FromSql(`select Count(Id) from diy_JFXFMX where IsDeleted =0 and (HexiaoZT = 'å·²å®Œæˆ' or HexiaoZT = 'å¾…è¯„ä»·' ) and ShanghuID = '${item.Id}' ` + where1).ToScalar()
  data.push(obj)
})
 
 
V8.Result = { Code : 1, Data : data, DataCount : Count}
```


Report Add! [Report Engine](/api_plugins/report02.png)

Design ReportAfter adding a report, click Report Design to enter the corresponding form design area.

! [Report Engine](/api_plugins/report03.png)

You can select the required space on the left and drag it to the middle form area. The form properties on the right can set the field properties of the control.
You can also pull in the required search condition controls as required, and configure the search condition code in the process engine as well.

ğŸŒˆNote: The field name must correspond to the data obtained from the process engine.

! [Report Engine](/api_plugins/report04.png)

ğŸŒˆNote: You can also select fields in an existing table or add all fields in the table by field configuration.

! [Report Engine](/api_plugins/report05.png)

Module engine assigns reports to pages1. å¦‚éœ€æ·»åŠ äºŒçº§èœå•ï¼Œæ‰“å¼€æ–¹å¼é€‰æ‹© `SecondMenu`ï¼Œæ·»åŠ è¡¨å•é€‰æ‹© `Diy`ã€‚
2. åœ¨è‡ªå®šä¹‰è¡¨ä¸­é€‰æ‹©åˆšåˆšæ–°å¢çš„æŠ¥è¡¨ï¼Œåœ¨ç•Œé¢æ¨¡æ¿ä¸­é€‰æ‹©æœç´¢ `+` è¡¨æ ¼ã€‚
3. æ’åºåˆ™æ˜¯åœ¨æ­¤çˆ¶çº§èœå•ä¸­çš„æ’åºé¡ºåºï¼Œè¶Šå°è¶Šé å‰ï¼Œä¸å¡«é»˜è®¤ä¸º `0` ã€‚

! [Report Engine](/api_plugins/report06.png)

permission assignment1. åœ¨å²—ä½è§’è‰²ä¸­é€‰æ‹©éœ€è¦çœ‹åˆ°æ­¤æŠ¥è¡¨çš„è§’è‰²ã€‚
2. åœ¨å¯¹åº”èœå•ä¸­å°†å…¶å¤é€‰æ¡†å‹¾ä¸Šã€‚
3. ç‚¹å‡»ä¿å­˜ã€‚
4. åˆ·æ–°æµè§ˆå™¨ï¼Œåˆ™å¯çœ‹åˆ°åˆšåˆ†é…çš„æŠ¥è¡¨å¼•æ“ã€‚

! [Report Engine](/api_plugins/report07.png)