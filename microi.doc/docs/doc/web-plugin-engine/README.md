# æ’ä»¶ç³»ç»Ÿæ–‡æ¡£

## æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäº Vue.js çš„ç°ä»£åŒ–æ’ä»¶ç³»ç»Ÿï¼Œæ”¯æŒåŠ¨æ€åŠ è½½ã€çƒ­æ’æ‹”ã€ç»„ä»¶å¤ç”¨ç­‰åŠŸèƒ½ã€‚ç³»ç»Ÿé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæä¾›å®Œæ•´çš„æ’ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿè½»æ¾æ‰©å±•åº”ç”¨åŠŸèƒ½ã€‚

## ç³»ç»Ÿæ¶æ„

```
src/views/plugins/
â”œâ”€â”€ index.js                    # æ’ä»¶ç³»ç»Ÿç»Ÿä¸€å…¥å£
â”œâ”€â”€ plugin-manager.js           # æ’ä»¶ç®¡ç†å™¨ï¼ˆæ ¸å¿ƒï¼‰
â”œâ”€â”€ plugin-config-manager.js    # é…ç½®ç®¡ç†å™¨
â”œâ”€â”€ plugin-discovery.js         # æ’ä»¶å‘ç°å™¨
â”œâ”€â”€ plugin-registry.js          # æ’ä»¶æ³¨å†Œå™¨
â”œâ”€â”€ plugin-importer.js          # æ’ä»¶å¯¼å…¥å™¨
â”œâ”€â”€ plugin-initializer.js       # æ’ä»¶åˆå§‹åŒ–å™¨
â”œâ”€â”€ plugin-component-adapter.js # ç»„ä»¶é€‚é…å™¨
â”œâ”€â”€ plugin-dependency-manager.js # ä¾èµ–ç®¡ç†å™¨
â”œâ”€â”€ plugin-dependency-loader.js # ä¾èµ–åŠ è½½å™¨
â”œâ”€â”€ plugin-config.js            # ç³»ç»Ÿé…ç½®æ–‡ä»¶
â”œâ”€â”€ test-plugin/                # æµ‹è¯•æ’ä»¶ç¤ºä¾‹
â”‚   â”œâ”€â”€ index.js               # æ’ä»¶é…ç½®
â”‚   â”œâ”€â”€ components/            # æ’ä»¶ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ TestHome.vue      # é¦–é¡µç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ TestCounter.vue   # è®¡æ•°å™¨ç»„ä»¶
â”‚   â”‚   â””â”€â”€ TestForm.vue      # è¡¨å•ç»„ä»¶
â”‚   â””â”€â”€ package.json          # æ’ä»¶åŒ…ä¿¡æ¯
â”œâ”€â”€ demo-plugin/               # æ¼”ç¤ºæ’ä»¶ç¤ºä¾‹
â”‚   â”œâ”€â”€ index.js              # æ’ä»¶é…ç½®
â”‚   â””â”€â”€ index.vue             # ä¸»ç»„ä»¶
â”œâ”€â”€ dependency-demo-plugin/    # ä¾èµ–ç®¡ç†æ¼”ç¤ºæ’ä»¶
â”‚   â”œâ”€â”€ index.js              # æ’ä»¶é…ç½®
â”‚   â”œâ”€â”€ components/           # æ’ä»¶ç»„ä»¶
â”‚   â”‚   â””â”€â”€ DependencyDemo.vue # ä¾èµ–æ¼”ç¤ºç»„ä»¶
â”‚   â”œâ”€â”€ utils/                # å†…éƒ¨å·¥å…·æ¨¡å—
â”‚   â”‚   â””â”€â”€ chart-utils.js    # å›¾è¡¨å·¥å…·
â”‚   â””â”€â”€ package.json          # æ’ä»¶åŒ…ä¿¡æ¯
â””â”€â”€ docs/                      # æ–‡æ¡£ç›®å½•
    â”œâ”€â”€ README.md                           # ç³»ç»Ÿæ¦‚è¿°ï¼ˆæœ¬æ–‡æ¡£ï¼‰
    â”œâ”€â”€ core-principles.md                  # æ ¸å¿ƒåŸç†è¯¦è§£
    â”œâ”€â”€ development-guide.md                # å¼€å‘æŒ‡å—
    â”œâ”€â”€ user-guide.md                       # ç”¨æˆ·ä½¿ç”¨æŒ‡å—
    â”œâ”€â”€ plugin-component-usage.md           # ç»„ä»¶ä½¿ç”¨è¯´æ˜
    â””â”€â”€ plugin-component-config-examples.md # é…ç½®ç¤ºä¾‹
```

## æ ¸å¿ƒæ¨¡å—è¯´æ˜

### 1. æ’ä»¶ç®¡ç†å™¨ (plugin-manager.js)
- **èŒè´£**ï¼šæ’ä»¶çš„æ³¨å†Œã€å¸è½½ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **åŠŸèƒ½**ï¼šè·¯ç”±æ³¨å†Œã€ç»„ä»¶æ³¨å†Œã€Vuexæ¨¡å—ç®¡ç†
- **ç‰¹ç‚¹**ï¼šæ”¯æŒçƒ­æ’æ‹”ï¼ŒåŠ¨æ€ç®¡ç†æ’ä»¶çŠ¶æ€

### 2. é…ç½®ç®¡ç†å™¨ (plugin-config-manager.js)
- **èŒè´£**ï¼šæ’ä»¶å¯ç”¨/ç¦ç”¨çŠ¶æ€ç®¡ç†
- **åŠŸèƒ½**ï¼šé…ç½®æŒä¹…åŒ–ã€ç”¨æˆ·åå¥½è®¾ç½®
- **ç‰¹ç‚¹**ï¼šåŸºäº localStorageï¼Œæ”¯æŒé…ç½®çƒ­æ›´æ–°

### 3. æ’ä»¶å‘ç°å™¨ (plugin-discovery.js)
- **èŒè´£**ï¼šæ’ä»¶é…ç½®çš„å‘ç°å’Œæ³¨å†Œ
- **åŠŸèƒ½**ï¼šåŠ¨æ€æ‰«æã€é…ç½®ç¼“å­˜ã€çŠ¶æ€æŸ¥è¯¢
- **ç‰¹ç‚¹**ï¼šæ”¯æŒè¿è¡Œæ—¶æ’ä»¶å‘ç°

### 4. æ’ä»¶æ³¨å†Œå™¨ (plugin-registry.js)
- **èŒè´£**ï¼šé›†ä¸­ç®¡ç†æ‰€æœ‰æ’ä»¶é…ç½®
- **åŠŸèƒ½**ï¼šæ’ä»¶å…ƒæ•°æ®ã€ä¾èµ–å…³ç³»ã€ç‰ˆæœ¬ç®¡ç†
- **ç‰¹ç‚¹**ï¼šç»Ÿä¸€çš„æ’ä»¶é…ç½®æ¥å£

### 5. æ’ä»¶å¯¼å…¥å™¨ (plugin-importer.js)
- **èŒè´£**ï¼šå¤„ç†æ’ä»¶çš„åŠ¨æ€å¯¼å…¥
- **åŠŸèƒ½**ï¼šWebpack å…¼å®¹ã€ç»„ä»¶æ˜ å°„ã€é”™è¯¯å¤„ç†
- **ç‰¹ç‚¹**ï¼šæ”¯æŒå¤šç§å¯¼å…¥ç­–ç•¥

### 6. æ’ä»¶åˆå§‹åŒ–å™¨ (plugin-initializer.js)
- **èŒè´£**ï¼šç³»ç»Ÿå¯åŠ¨æ—¶çš„æ’ä»¶åˆå§‹åŒ–
- **åŠŸèƒ½**ï¼šä¾èµ–æ³¨å…¥ã€å¯åŠ¨é¡ºåºã€é”™è¯¯æ¢å¤
- **ç‰¹ç‚¹**ï¼šæ™ºèƒ½åˆå§‹åŒ–ï¼Œæ”¯æŒå¤±è´¥é‡è¯•

### 7. ç»„ä»¶é€‚é…å™¨ (plugin-component-adapter.js)
- **èŒè´£**ï¼šæ’ä»¶ç»„ä»¶çš„ç»Ÿä¸€ç®¡ç†
- **åŠŸèƒ½**ï¼šç»„ä»¶æ³¨å†Œã€åŠ¨æ€å¯¼å…¥ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **ç‰¹ç‚¹**ï¼šæ”¯æŒå¤šç§ç»„ä»¶ç±»å‹ï¼Œæ™ºèƒ½ç¼“å­˜

### 8. ä¾èµ–ç®¡ç†å™¨ (plugin-dependency-manager.js)
- **èŒè´£**ï¼šæ’ä»¶ä¾èµ–çš„ç‹¬ç«‹ç®¡ç†
- **åŠŸèƒ½**ï¼šä¾èµ–è§£æã€åŠ¨æ€åŠ è½½ã€ç‰ˆæœ¬ç®¡ç†
- **ç‰¹ç‚¹**ï¼šæ”¯æŒå¤šç§ä¾èµ–ç±»å‹ï¼Œé¿å…ä¸»é¡¹ç›®æ±¡æŸ“

### 9. ä¾èµ–åŠ è½½å™¨ (plugin-dependency-loader.js)
- **èŒè´£**ï¼šæ’ä»¶ä¾èµ–çš„åŠ¨æ€åŠ è½½
- **åŠŸèƒ½**ï¼šCDNåŠ è½½ã€æœ¬åœ°å¯¼å…¥ã€ä¾èµ–æ³¨å…¥
- **ç‰¹ç‚¹**ï¼šæ™ºèƒ½ç¼“å­˜ã€é”™è¯¯å¤„ç†ã€é™çº§æ–¹æ¡ˆ

## æ ¸å¿ƒåŸç†

### 1. åŠ¨æ€å¯¼å…¥æœºåˆ¶
```javascript
// ä½¿ç”¨ Webpack çš„ require.context åŠ¨æ€å¯¼å…¥
const pluginContext = require.context('@/views/plugins', true, /^\.\/([^/]+)\/index\.js$/)
```

### 2. ç»„ä»¶æ³¨å†Œç­–ç•¥
```javascript
// æ”¯æŒå¤šç§ç»„ä»¶æ¥æº
- Vue å•æ–‡ä»¶ç»„ä»¶ (.vue)
- å†…è”å®šä¹‰ç»„ä»¶ (JavaScript å¯¹è±¡)
- åŠ¨æ€å¯¼å…¥ç»„ä»¶ (å¼‚æ­¥åŠ è½½)
```

### 3. è·¯ç”±åŠ¨æ€æ³¨å†Œ
```javascript
// è‡ªåŠ¨ä¸ºæ’ä»¶è·¯ç”±æ·»åŠ å‰ç¼€
path: `/plugin/${pluginName}${route.path}`
```

### 4. é…ç½®çƒ­æ›´æ–°
```javascript
// åŸºäº localStorage çš„é…ç½®æŒä¹…åŒ–
// æ”¯æŒè¿è¡Œæ—¶é…ç½®æ›´æ–°
```

### 5. ç‹¬ç«‹ä¾èµ–ç®¡ç†
```javascript
// æ’ä»¶å¯ä»¥å®šä¹‰è‡ªå·±çš„ä¾èµ–ï¼Œæ— éœ€åœ¨ä¸»é¡¹ç›®ä¸­é…ç½®
export const dependencies = {
  'lodash': {
    type: 'external',
    version: '^4.17.21',
    source: 'https://unpkg.com/lodash@4.17.21/lodash.min.js'
  }
}
```

## å¿«é€Ÿå¼€å§‹

### 1. åˆå§‹åŒ–æ’ä»¶ç³»ç»Ÿ

```javascript
import { initializePluginSystem } from '@/views/plugins'

// åœ¨åº”ç”¨å¯åŠ¨æ—¶åˆå§‹åŒ–
await initializePluginSystem({
  router: this.$router,
  store: this.$store
})
```

### 2. ä½¿ç”¨æ’ä»¶ç®¡ç†åŠŸèƒ½

```javascript
import { pluginManager, pluginConfigManager } from '@/views/plugins'

// å¯ç”¨æ’ä»¶
pluginConfigManager.enablePlugin('test-plugin')
await pluginManager.registerPlugin('test-plugin', { enabled: true })

// ç¦ç”¨æ’ä»¶
pluginConfigManager.disablePlugin('test-plugin')
await pluginManager.unregisterPlugin('test-plugin')
```

### 3. åœ¨é€‰ä¸­åŒºåŸŸä¸­æ¸²æŸ“æ’ä»¶ç»„ä»¶

```javascript
// è¡¨å•å­—æ®µé…ç½®
{
  "Component": "DevComponent",
  "Config": {
    "DevComponentName": "test-plugin-TestHome",
    "DevComponentPath": "/plugins/test-plugin/components/TestHome.vue"
  }
}
```

## æ’ä»¶ç³»ç»Ÿç‰¹æ€§

### âœ… **æ ¸å¿ƒåŠŸèƒ½**
- åŠ¨æ€æ’ä»¶åŠ è½½å’Œå¸è½½
- ç»„ä»¶çƒ­æ’æ‹”
- è·¯ç”±è‡ªåŠ¨æ³¨å†Œ
- é…ç½®æŒä¹…åŒ–
- ç‹¬ç«‹ä¾èµ–ç®¡ç†
- é”™è¯¯å¤„ç†å’Œæ¢å¤

### âœ… **å¼€å‘ä½“éªŒ**
- é›¶é…ç½®å¯åŠ¨
- çƒ­é‡è½½æ”¯æŒ
- å®Œæ•´çš„ç±»å‹æç¤º
- ä¸°å¯Œçš„è°ƒè¯•ä¿¡æ¯
- è¯¦ç»†çš„é”™è¯¯æ—¥å¿—

### âœ… **æ€§èƒ½ä¼˜åŒ–**
- æŒ‰éœ€åŠ è½½
- ç»„ä»¶ç¼“å­˜
- æ™ºèƒ½é¢„åŠ è½½
- å†…å­˜ç®¡ç†
- å¯åŠ¨ä¼˜åŒ–

### âœ… **æ‰©å±•æ€§**
- æ’ä»¶ç”Ÿå‘½å‘¨æœŸé’©å­
- äº‹ä»¶ç³»ç»Ÿ
- ä¸­é—´ä»¶æ”¯æŒ
- è‡ªå®šä¹‰é…ç½®
- æ’ä»¶é—´é€šä¿¡

## ä½¿ç”¨åœºæ™¯

### 1. **åŠŸèƒ½æ¨¡å—åŒ–**
- å°†å¤æ‚åŠŸèƒ½æ‹†åˆ†ä¸ºç‹¬ç«‹æ’ä»¶
- æŒ‰éœ€åŠ è½½ï¼Œæå‡æ€§èƒ½
- å›¢é˜Ÿåä½œå¼€å‘

### 2. **ä¸šåŠ¡æ‰©å±•**
- å¿«é€Ÿæ·»åŠ æ–°åŠŸèƒ½
- æ”¯æŒç¬¬ä¸‰æ–¹æ’ä»¶
- åŠ¨æ€åŠŸèƒ½å¼€å…³

### 3. **ç»„ä»¶å¤ç”¨**
- è·¨é¡¹ç›®ç»„ä»¶å…±äº«
- æ ‡å‡†åŒ–ç»„ä»¶åº“
- ç‰ˆæœ¬ç®¡ç†

### 4. **ç³»ç»Ÿé›†æˆ**
- å¾®å‰ç«¯æ¶æ„
- æ¨¡å—è”é‚¦
- åˆ†å¸ƒå¼éƒ¨ç½²

## æœ€ä½³å®è·µ

### 1. **æ’ä»¶è®¾è®¡åŸåˆ™**
- å•ä¸€èŒè´£ï¼šä¸€ä¸ªæ’ä»¶ä¸“æ³¨ä¸€ä¸ªåŠŸèƒ½
- æ¾è€¦åˆï¼šå‡å°‘æ’ä»¶é—´ä¾èµ–
- é«˜å†…èšï¼šç›¸å…³åŠŸèƒ½é›†ä¸­ç®¡ç†
- å¯é…ç½®ï¼šæ”¯æŒè¿è¡Œæ—¶é…ç½®

### 2. **æ€§èƒ½è€ƒè™‘**
- åˆç†ä½¿ç”¨æ‡’åŠ è½½
- é¿å…å¾ªç¯ä¾èµ–
- åŠæ—¶æ¸…ç†èµ„æº
- ç›‘æ§å†…å­˜ä½¿ç”¨

### 3. **é”™è¯¯å¤„ç†**
- ä¼˜é›…é™çº§
- é”™è¯¯è¾¹ç•Œ
- ç”¨æˆ·å‹å¥½æç¤º
- è¯¦ç»†é”™è¯¯æ—¥å¿—

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ’ä»¶æ— æ³•åŠ è½½**
   - æ£€æŸ¥æ’ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤æ’ä»¶æ˜¯å¦å·²å¯ç”¨
   - æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯

2. **ç»„ä»¶æ¸²æŸ“å¤±è´¥**
   - éªŒè¯ç»„ä»¶é…ç½®æ ¼å¼
   - æ£€æŸ¥ç»„ä»¶æ–‡ä»¶æ˜¯å¦å­˜åœ¨
   - ç¡®è®¤ç»„ä»¶è¯­æ³•æ­£ç¡®

3. **è·¯ç”±ä¸ç”Ÿæ•ˆ**
   - æ£€æŸ¥è·¯ç”±é…ç½®æ ¼å¼
   - ç¡®è®¤æ’ä»¶å·²å¯ç”¨
   - éªŒè¯è·¯ç”±è·¯å¾„æ­£ç¡®

### è°ƒè¯•æŠ€å·§

- ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·
- æŸ¥çœ‹æ’ä»¶ç³»ç»ŸçŠ¶æ€
- æ£€æŸ¥ç»„ä»¶æ³¨å†ŒçŠ¶æ€
- ç›‘æ§ç½‘ç»œè¯·æ±‚

## æ€»ç»“

è¿™ä¸ªæ’ä»¶ç³»ç»Ÿæä¾›äº†ï¼š

1. **å®Œæ•´çš„æ’ä»¶ç”Ÿæ€**ï¼šä»å¼€å‘åˆ°éƒ¨ç½²çš„å…¨æµç¨‹æ”¯æŒ
2. **çµæ´»çš„æ¶æ„è®¾è®¡**ï¼šæ”¯æŒå¤šç§ä½¿ç”¨åœºæ™¯å’Œæ‰©å±•éœ€æ±‚
3. **ä¼˜ç§€çš„å¼€å‘ä½“éªŒ**ï¼šé›¶é…ç½®ã€çƒ­é‡è½½ã€ç±»å‹æç¤º
4. **å¼ºå¤§çš„æ€§èƒ½ä¼˜åŒ–**ï¼šæŒ‰éœ€åŠ è½½ã€æ™ºèƒ½ç¼“å­˜ã€å†…å­˜ç®¡ç†
5. **å®Œå–„çš„é”™è¯¯å¤„ç†**ï¼šä¼˜é›…é™çº§ã€è¯¦ç»†æ—¥å¿—ã€ç”¨æˆ·å‹å¥½

å¼€å§‹ä½¿ç”¨æ’ä»¶ç³»ç»Ÿï¼Œè®©ä½ çš„åº”ç”¨æ›´åŠ æ¨¡å—åŒ–å’Œå¯æ‰©å±•ï¼

## ğŸ“š æ–‡æ¡£å¯¼èˆª

### æ ¸å¿ƒæ–‡æ¡£
- **[README.md](README.md)** - ç³»ç»Ÿæ¦‚è¿°å’Œæ¶æ„è¯´æ˜ï¼ˆæœ¬æ–‡æ¡£ï¼‰
- **[core-principles.md](core-principles.md)** - æ ¸å¿ƒåŸç†å’ŒæŠ€æœ¯å®ç°è¯¦è§£
- **[development-guide.md](development-guide.md)** - æ’ä»¶å¼€å‘å®Œæ•´æŒ‡å—

### ä½¿ç”¨æ–‡æ¡£
- **[user-guide.md](user-guide.md)** - ç”¨æˆ·ä½¿ç”¨æŒ‡å—å’Œå¸¸è§é—®é¢˜è§£å†³
- **[plugin-component-usage.md](plugin-component-usage.md)** - æ’ä»¶ç»„ä»¶ä½¿ç”¨è¯´æ˜
- **[plugin-component-config-examples.md](plugin-component-config-examples.md)** - ç»„ä»¶é…ç½®ç¤ºä¾‹

### å¿«é€Ÿé“¾æ¥
- **æ’ä»¶ç®¡ç†**ï¼šè®¿é—®æ’ä»¶ç®¡ç†é¡µé¢å¯ç”¨/ç¦ç”¨æ’ä»¶
- **å¼€å‘ç¤ºä¾‹**ï¼šå‚è€ƒ `test-plugin` å’Œ `demo-plugin` ç›®å½•
- **API å‚è€ƒ**ï¼šæŸ¥çœ‹å„æ¨¡å—çš„è¯¦ç»† API æ–‡æ¡£

---

**å¼€å§‹ä½ çš„æ’ä»¶å¼€å‘ä¹‹æ—…å§ï¼** ğŸš€ 