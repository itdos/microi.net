# AIè¾…åŠ©å¼€å‘ - æ¥å£å¼•æ“ä»£ç åº“

> æœ¬ç›®å½•å­˜æ”¾ç”¨äºAIè¾…åŠ©å¼€å‘çš„æ¥å£å¼•æ“ä»£ç ç¤ºä¾‹å’Œå·¥å…·ç±»æ¥å£

## ğŸ“ æ–‡ä»¶è¯´æ˜

### get-database-schema.js
**è·å–æ•°æ®åº“ç»“æ„ä¿¡æ¯æ¥å£**

**ç”¨é€”**ï¼š
- è·å–ç³»ç»Ÿæ‰€æœ‰è¡¨ä¿¡æ¯ï¼ˆdiy_tableï¼‰
- è·å–æ‰€æœ‰å­—æ®µä¿¡æ¯ï¼ˆdiy_fieldï¼‰
- è·å–ç³»ç»Ÿé…ç½®ä¿¡æ¯ï¼ˆsys_configï¼‰
- è‡ªåŠ¨å°†å­—æ®µæŒ‰è¡¨åˆ†ç»„ï¼Œä¾¿äºAIç†è§£

**ä½¿ç”¨æ–¹æ³•**ï¼š
1. åœ¨Microiåå°åˆ›å»ºä¸€ä¸ªæ–°çš„æ¥å£å¼•æ“
2. å°† `get-database-schema.js` çš„ä»£ç å¤åˆ¶åˆ°æ¥å£å¼•æ“ä¸­
3. é…ç½®æ¥å£ï¼š
   - ApiName: `è·å–æ•°æ®åº“ç»“æ„ä¿¡æ¯`
   - ApiEngineKey: `get-database-schema`
   - ApiAddress: `/apiengine/get-database-schema`
   - å…è®¸åŒ¿åè°ƒç”¨: å¦ï¼ˆéœ€è¦ç™»å½•ï¼‰
4. ä¿å­˜åè°ƒç”¨æ¥å£
5. å°†è¿”å›çš„JSONæ•°æ®æä¾›ç»™AI

**è¿”å›æ•°æ®ç»“æ„**ï¼š
```json
{
  "Code": 1,
  "Msg": "è·å–æ•°æ®åº“ç»“æ„æˆåŠŸï¼",
  "Data": {
    "Tables": [],        // æ‰€æœ‰è¡¨ä¿¡æ¯æ•°ç»„
    "Fields": [],        // æ‰€æœ‰å­—æ®µä¿¡æ¯æ•°ç»„
    "TableMap": {},      // æŒ‰è¡¨ååˆ†ç»„çš„ç»“æ„ { "è¡¨å": { TableInfo: {}, Fields: [] } }
    "SystemConfig": [],  // ç³»ç»Ÿé…ç½®ä¿¡æ¯
    "Statistics": {
      "TableCount": 100,
      "FieldCount": 1500,
      "ConfigCount": 50
    }
  },
  "DataAppend": {
    "GenerateTime": "2026-01-11 10:30:00",
    "Tips": "æ•°æ®åº“ç»“æ„ä¿¡æ¯å·²æˆåŠŸè·å–ï¼Œå¯æä¾›ç»™AIè¿›è¡Œå­¦ä¹ åˆ†æ"
  }
}
```

**å…³é”®å­—æ®µè¯´æ˜**ï¼š

**diy_tableè¡¨å­—æ®µ**ï¼š
- TableName: è¡¨å
- TableComment: è¡¨è¯´æ˜
- TableType: è¡¨ç±»å‹
- IsDeleted: æ˜¯å¦åˆ é™¤

**diy_fieldè¡¨å­—æ®µ**ï¼š
- TableName: æ‰€å±è¡¨å
- FieldName: å­—æ®µå
- FieldComment: å­—æ®µè¯´æ˜
- FieldType: å­—æ®µç±»å‹ï¼ˆå¦‚ï¼švarcharã€intã€datetimeç­‰ï¼‰
- IsRequired: æ˜¯å¦å¿…å¡«
- DefaultValue: é»˜è®¤å€¼
- IsDeleted: æ˜¯å¦åˆ é™¤

---

## ğŸ¯ AIå­¦ä¹ æµç¨‹

### æ­¥éª¤1ï¼šè·å–æ•°æ®åº“ç»“æ„
è°ƒç”¨ `get-database-schema` æ¥å£ï¼Œè·å–å®Œæ•´çš„æ•°æ®åº“ç»“æ„ä¿¡æ¯

### æ­¥éª¤2ï¼šæä¾›ç»™AI
å°†æ¥å£è¿”å›çš„JSONæ•°æ®å®Œæ•´æä¾›ç»™AIï¼Œæ ¼å¼å¦‚ä¸‹ï¼š

```
è¿™æ˜¯æˆ‘çš„æ•°æ®åº“ç»“æ„ä¿¡æ¯ï¼š

è¡¨æ•°é‡ï¼š100å¼ 
å­—æ®µæ•°é‡ï¼š1500ä¸ª

ã€è¡¨ç»“æ„è¯¦æƒ…ã€‘
[ç²˜è´´Data.TableMapçš„å†…å®¹]

ã€ç³»ç»Ÿé…ç½®ã€‘
[ç²˜è´´Data.SystemConfigçš„å†…å®¹]
```

### æ­¥éª¤3ï¼šAIåˆ†æç†è§£
AIä¼šè‡ªåŠ¨åˆ†æï¼š
- è¡¨ä¹‹é—´çš„å…³è”å…³ç³»ï¼ˆé€šè¿‡å­—æ®µåæ¨æ–­ï¼Œå¦‚ï¼šUserIdå…³è”diy_userè¡¨ï¼‰
- å­—æ®µç±»å‹å’Œä¸šåŠ¡å«ä¹‰
- å¸¸ç”¨æŸ¥è¯¢æ¡ä»¶ï¼ˆå¦‚ï¼šIsDeleted=0ï¼‰
- ä¸šåŠ¡è§„åˆ™ï¼ˆå¦‚ï¼šStatuså­—æ®µçš„æšä¸¾å€¼ï¼‰

### æ­¥éª¤4ï¼šæè¿°ä¸šåŠ¡éœ€æ±‚
ç›´æ¥å‘AIæè¿°ä¸šåŠ¡é€»è¾‘ï¼ŒAIä¼šæ ¹æ®æ•°æ®åº“ç»“æ„ç”Ÿæˆå¯¹åº”çš„æ¥å£å¼•æ“ä»£ç 

**ç¤ºä¾‹**ï¼š
> "å†™ä¸€ä¸ªè·å–ç”¨æˆ·è®¢å•åˆ—è¡¨çš„æ¥å£ï¼Œéœ€è¦ï¼š
> 1. æ ¹æ®ç”¨æˆ·IDæŸ¥è¯¢è®¢å•
> 2. å…³è”è®¢å•æ˜ç»†è¡¨
> 3. å…³è”å•†å“è¡¨è·å–å•†å“åç§°
> 4. æ”¯æŒæŒ‰è®¢å•çŠ¶æ€ç­›é€‰
> 5. æ”¯æŒåˆ†é¡µ"

AIä¼šè‡ªåŠ¨ï¼š
- æ‰¾åˆ°ç›¸å…³è¡¨ï¼ˆdiy_orderã€diy_order_detailã€diy_productç­‰ï¼‰
- ç”Ÿæˆæ­£ç¡®çš„Whereæ¡ä»¶
- ä½¿ç”¨V8.FormEngineæˆ–V8.ModuleEngine
- å¤„ç†åˆ†é¡µé€»è¾‘
- è¿”å›ç¬¦åˆMicroiè§„èŒƒçš„æ•°æ®æ ¼å¼

---

## ğŸ’¡ ä¼˜åŒ–å»ºè®®

### å¦‚æœè¡¨å¤ªå¤šï¼ˆè¶…è¿‡100å¼ ï¼‰
å¯ä»¥ä¿®æ”¹æ¥å£ä»£ç ï¼Œæ”¯æŒæŒ‰æ¨¡å—ç­›é€‰ï¼š

```javascript
// åªè·å–è®¢å•ç›¸å…³çš„è¡¨
var tableResult = V8.FormEngine.GetTableData('diy_table', {
  _Where: [
    ['IsDeleted', '=', 0],
    ['TableName', 'Like', 'order']  // åªè·å–åŒ…å«orderçš„è¡¨
  ],
  _PageSize: 9999
});
```

### å®šæœŸæ›´æ–°
å½“æ•°æ®åº“ç»“æ„å‘ç”Ÿå˜åŒ–æ—¶ï¼ˆæ–°å¢è¡¨ã€ä¿®æ”¹å­—æ®µï¼‰ï¼Œé‡æ–°è°ƒç”¨æ¥å£è·å–æœ€æ–°ç»“æ„

### æ•æ„Ÿä¿¡æ¯å¤„ç†
å¦‚æœæŸäº›è¡¨æˆ–å­—æ®µåŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œå¯ä»¥åœ¨æ¥å£ä¸­è¿‡æ»¤ï¼š

```javascript
// è¿‡æ»¤æ•æ„Ÿè¡¨
var sensitiveTableNames = ['sys_password', 'sys_secret'];
tableResult.Data = tableResult.Data.filter(function(table) {
  return sensitiveTableNames.indexOf(table.TableName) === -1;
});
```

---

## ğŸš€ å¼€å§‹ä½¿ç”¨

1. å¤åˆ¶ `get-database-schema.js` ä»£ç åˆ°Microiæ¥å£å¼•æ“
2. è°ƒç”¨æ¥å£è·å–æ•°æ®åº“ç»“æ„
3. å°†è¿”å›æ•°æ®æä¾›ç»™AI
4. å¼€å§‹æè¿°ä¸šåŠ¡éœ€æ±‚ï¼Œè®©AIå¸®æ‚¨å†™ä»£ç ï¼

---

## ğŸ“ é—®é¢˜åé¦ˆ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»æŠ€æœ¯æ”¯æŒã€‚
